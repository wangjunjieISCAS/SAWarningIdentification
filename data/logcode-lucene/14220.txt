GitDiffStart: ac96d90b53bcdacdfc4b625d43b940b31cabeee5 | Sat Dec 17 12:57:41 2011 +0000
diff --git a/lucene/src/java/org/apache/lucene/messages/Message.java b/lucene/src/java/org/apache/lucene/messages/Message.java
deleted file mode 100644
index df7ac82..0000000
--- a/lucene/src/java/org/apache/lucene/messages/Message.java
+++ /dev/null
@@ -1,36 +0,0 @@
-package org.apache.lucene.messages;
-
-/**
- * Licensed to the Apache Software Foundation (ASF) under one or more
- * contributor license agreements.  See the NOTICE file distributed with
- * this work for additional information regarding copyright ownership.
- * The ASF licenses this file to You under the Apache License, Version 2.0
- * (the "License"); you may not use this file except in compliance with
- * the License.  You may obtain a copy of the License at
- *
- *     http://www.apache.org/licenses/LICENSE-2.0
- *
- * Unless required by applicable law or agreed to in writing, software
- * distributed under the License is distributed on an "AS IS" BASIS,
- * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
- * See the License for the specific language governing permissions and
- * limitations under the License.
- */
-
-import java.util.Locale;
-
-/**
- * Message Interface for a lazy loading.
- * For Native Language Support (NLS), system of software internationalization.
- */
-public interface Message {
-
-  public String getKey();
-
-  public Object[] getArguments();
-
-  public String getLocalizedMessage();
-
-  public String getLocalizedMessage(Locale locale);
-
-}
diff --git a/lucene/src/java/org/apache/lucene/messages/MessageImpl.java b/lucene/src/java/org/apache/lucene/messages/MessageImpl.java
deleted file mode 100644
index 78d8e2b..0000000
--- a/lucene/src/java/org/apache/lucene/messages/MessageImpl.java
+++ /dev/null
@@ -1,70 +0,0 @@
-package org.apache.lucene.messages;
-
-/**
- * Licensed to the Apache Software Foundation (ASF) under one or more
- * contributor license agreements.  See the NOTICE file distributed with
- * this work for additional information regarding copyright ownership.
- * The ASF licenses this file to You under the Apache License, Version 2.0
- * (the "License"); you may not use this file except in compliance with
- * the License.  You may obtain a copy of the License at
- *
- *     http://www.apache.org/licenses/LICENSE-2.0
- *
- * Unless required by applicable law or agreed to in writing, software
- * distributed under the License is distributed on an "AS IS" BASIS,
- * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
- * See the License for the specific language governing permissions and
- * limitations under the License.
- */
-
-import java.util.Locale;
-
-/**
- * Default implementation of Message interface.
- * For Native Language Support (NLS), system of software internationalization.
- */
-public class MessageImpl implements Message {
-
-  private String key;
-
-  private Object[] arguments = new Object[0];
-
-  public MessageImpl(String key) {
-    this.key = key;
-
-  }
-
-  public MessageImpl(String key, Object... args) {
-    this(key);
-    this.arguments = args;
-  }
-
-  public Object[] getArguments() {
-    return this.arguments;
-  }
-
-  public String getKey() {
-    return this.key;
-  }
-
-  public String getLocalizedMessage() {
-    return getLocalizedMessage(Locale.getDefault());
-  }
-
-  public String getLocalizedMessage(Locale locale) {
-    return NLS.getLocalizedMessage(getKey(), locale, getArguments());
-  }
-
-  @Override
-  public String toString() {
-    Object[] args = getArguments();
-    StringBuilder sb = new StringBuilder(getKey());
-    if (args != null) {
-      for (int i = 0; i < args.length; i++) {
-        sb.append(i == 0 ? " " : ", ").append(args[i]);
-      }
-    }
-    return sb.toString();
-  }
-
-}
diff --git a/lucene/src/java/org/apache/lucene/messages/NLS.java b/lucene/src/java/org/apache/lucene/messages/NLS.java
deleted file mode 100644
index ec90cb1..0000000
--- a/lucene/src/java/org/apache/lucene/messages/NLS.java
+++ /dev/null
@@ -1,206 +0,0 @@
-package org.apache.lucene.messages;
-
-/**
- * Licensed to the Apache Software Foundation (ASF) under one or more
- * contributor license agreements.  See the NOTICE file distributed with
- * this work for additional information regarding copyright ownership.
- * The ASF licenses this file to You under the Apache License, Version 2.0
- * (the "License"); you may not use this file except in compliance with
- * the License.  You may obtain a copy of the License at
- *
- *     http://www.apache.org/licenses/LICENSE-2.0
- *
- * Unless required by applicable law or agreed to in writing, software
- * distributed under the License is distributed on an "AS IS" BASIS,
- * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
- * See the License for the specific language governing permissions and
- * limitations under the License.
- */
-
-import java.lang.reflect.Field;
-import java.lang.reflect.Modifier;
-import java.security.AccessController;
-import java.security.PrivilegedAction;
-import java.text.MessageFormat;
-import java.util.HashMap;
-import java.util.Iterator;
-import java.util.Locale;
-import java.util.Map;
-import java.util.MissingResourceException;
-import java.util.ResourceBundle;
-
-/**
- * MessageBundles classes extend this class, to implement a bundle.
- * 
- * For Native Language Support (NLS), system of software internationalization.
- * 
- * This interface is similar to the NLS class in eclipse.osgi.util.NLS class -
- * initializeMessages() method resets the values of all static strings, should
- * only be called by classes that extend from NLS (see TestMessages.java for
- * reference) - performs validation of all message in a bundle, at class load
- * time - performs per message validation at runtime - see NLSTest.java for
- * usage reference
- * 
- * MessageBundle classes may subclass this type.
- */
-public class NLS {
-
-  private static Map<String, Class<? extends NLS>> bundles = 
-    new HashMap<String, Class<? extends NLS>>(0);
-
-  protected NLS() {
-    // Do not instantiate
-  }
-
-  public static String getLocalizedMessage(String key) {
-    return getLocalizedMessage(key, Locale.getDefault());
-  }
-
-  public static String getLocalizedMessage(String key, Locale locale) {
-    Object message = getResourceBundleObject(key, locale);
-    if (message == null) {
-      return "Message with key:" + key + " and locale: " + locale
-          + " not found.";
-    }
-    return message.toString();
-  }
-
-  public static String getLocalizedMessage(String key, Locale locale,
-      Object... args) {
-    String str = getLocalizedMessage(key, locale);
-
-    if (args.length > 0) {
-      str = MessageFormat.format(str, args);
-    }
-
-    return str;
-  }
-
-  public static String getLocalizedMessage(String key, Object... args) {
-    return getLocalizedMessage(key, Locale.getDefault(), args);
-  }
-
-  /**
-   * Initialize a given class with the message bundle Keys Should be called from
-   * a class that extends NLS in a static block at class load time.
-   * 
-   * @param bundleName
-   *          Property file with that contains the message bundle
-   * @param clazz
-   *          where constants will reside
-   */
-  protected static void initializeMessages(String bundleName, Class<? extends NLS> clazz) {
-    try {
-      load(clazz);
-      if (!bundles.containsKey(bundleName))
-        bundles.put(bundleName, clazz);
-    } catch (Throwable e) {
-      // ignore all errors and exceptions
-      // because this function is supposed to be called at class load time.
-    }
-  }
-
-  private static Object getResourceBundleObject(String messageKey, Locale locale) {
-
-    // slow resource checking
-    // need to loop thru all registered resource bundles
-    for (Iterator<String> it = bundles.keySet().iterator(); it.hasNext();) {
-      Class<? extends NLS> clazz = bundles.get(it.next());
-      ResourceBundle resourceBundle = ResourceBundle.getBundle(clazz.getName(),
-          locale);
-      if (resourceBundle != null) {
-        try {
-          Object obj = resourceBundle.getObject(messageKey);
-          if (obj != null)
-            return obj;
-        } catch (MissingResourceException e) {
-          // just continue it might be on the next resource bundle
-        }
-      }
-    }
-    // if resource is not found
-    return null;
-  }
-
-  /**
-   * @param clazz
-   */
-  private static void load(Class<? extends NLS> clazz) {
-    final Field[] fieldArray = clazz.getDeclaredFields();
-
-    boolean isFieldAccessible = (clazz.getModifiers() & Modifier.PUBLIC) != 0;
-
-    // build a map of field names to Field objects
-    final int len = fieldArray.length;
-    Map<String, Field> fields = new HashMap<String, Field>(len * 2);
-    for (int i = 0; i < len; i++) {
-      fields.put(fieldArray[i].getName(), fieldArray[i]);
-      loadfieldValue(fieldArray[i], isFieldAccessible, clazz);
-    }
-  }
-
-  /**
-   * @param field
-   * @param isFieldAccessible
-   */
-  private static void loadfieldValue(Field field, boolean isFieldAccessible,
-      Class<? extends NLS> clazz) {
-    int MOD_EXPECTED = Modifier.PUBLIC | Modifier.STATIC;
-    int MOD_MASK = MOD_EXPECTED | Modifier.FINAL;
-    if ((field.getModifiers() & MOD_MASK) != MOD_EXPECTED)
-      return;
-
-    // Set a value for this empty field.
-    if (!isFieldAccessible)
-      makeAccessible(field);
-    try {
-      field.set(null, field.getName());
-      validateMessage(field.getName(), clazz);
-    } catch (IllegalArgumentException e) {
-      // should not happen
-    } catch (IllegalAccessException e) {
-      // should not happen
-    }
-  }
-
-  /**
-   * @param key
-   *          - Message Key
-   */
-  private static void validateMessage(String key, Class<? extends NLS> clazz) {
-    // Test if the message is present in the resource bundle
-    try {
-      ResourceBundle resourceBundle = ResourceBundle.getBundle(clazz.getName(),
-          Locale.getDefault());
-      if (resourceBundle != null) {
-        Object obj = resourceBundle.getObject(key);
-        if (obj == null)
-          System.err.println("WARN: Message with key:" + key + " and locale: "
-              + Locale.getDefault() + " not found.");
-      }
-    } catch (MissingResourceException e) {
-      System.err.println("WARN: Message with key:" + key + " and locale: "
-          + Locale.getDefault() + " not found.");
-    } catch (Throwable e) {
-      // ignore all other errors and exceptions
-      // since this code is just a test to see if the message is present on the
-      // system
-    }
-  }
-
-  /*
-   * Make a class field accessible
-   */
-  private static void makeAccessible(final Field field) {
-    if (System.getSecurityManager() == null) {
-      field.setAccessible(true);
-    } else {
-      AccessController.doPrivileged(new PrivilegedAction<Void>() {
-        public Void run() {
-          field.setAccessible(true);
-          return null;
-        }
-      });
-    }
-  }
-}
diff --git a/lucene/src/java/org/apache/lucene/messages/NLSException.java b/lucene/src/java/org/apache/lucene/messages/NLSException.java
deleted file mode 100644
index 0c6b904..0000000
--- a/lucene/src/java/org/apache/lucene/messages/NLSException.java
+++ /dev/null
@@ -1,34 +0,0 @@
-package org.apache.lucene.messages;
-
-/**
- * Licensed to the Apache Software Foundation (ASF) under one or more
- * contributor license agreements.  See the NOTICE file distributed with
- * this work for additional information regarding copyright ownership.
- * The ASF licenses this file to You under the Apache License, Version 2.0
- * (the "License"); you may not use this file except in compliance with
- * the License.  You may obtain a copy of the License at
- *
- *     http://www.apache.org/licenses/LICENSE-2.0
- *
- * Unless required by applicable law or agreed to in writing, software
- * distributed under the License is distributed on an "AS IS" BASIS,
- * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
- * See the License for the specific language governing permissions and
- * limitations under the License.
- */
-
-/**
- * Interface that exceptions should implement to support lazy loading of messages.
- * 
- * For Native Language Support (NLS), system of software internationalization.
- * 
- * This Interface should be implemented by all exceptions that require
- * translation
- * 
- */
-public interface NLSException {
-  /**
-   * @return a instance of a class that implements the Message interface
-   */
-  public Message getMessageObject();
-}
diff --git a/lucene/src/java/org/apache/lucene/messages/package.html b/lucene/src/java/org/apache/lucene/messages/package.html
deleted file mode 100644
index 24d4171..0000000
--- a/lucene/src/java/org/apache/lucene/messages/package.html
+++ /dev/null
@@ -1,99 +0,0 @@
-<!doctype html public "-//w3c//dtd html 4.0 transitional//en">
-<!--
- Licensed to the Apache Software Foundation (ASF) under one or more
- contributor license agreements.  See the NOTICE file distributed with
- this work for additional information regarding copyright ownership.
- The ASF licenses this file to You under the Apache License, Version 2.0
- (the "License"); you may not use this file except in compliance with
- the License.  You may obtain a copy of the License at
-
-     http://www.apache.org/licenses/LICENSE-2.0
-
- Unless required by applicable law or agreed to in writing, software
- distributed under the License is distributed on an "AS IS" BASIS,
- WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
- See the License for the specific language governing permissions and
- limitations under the License.
--->
-<html>
-<head>
-   <meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
-</head>
-<body>
-
-For Native Language Support (NLS), system of software internationalization.
-
-<h2>NLS message API</h2>
-<p>
-This utility API, adds support for NLS messages in the apache code.
-It is currently used by the lucene "New Flexible Query PArser".
-</p>
-<p>
-Features:
-    <ol>
-        <li>Message reference in the code, using static Strings</li>
-        <li>Message resource validation at class load time, for easier debugging</li>
-        <li>Allows for message IDs to be re-factored using eclipse or other code re-factor tools</li>
-        <li>Allows for reference count on messages, just like code</li>
-		<li>Lazy loading of Message Strings</li>        
-        <li>Normal loading Message Strings</li>                  
-    </ol>
-</p>
-
-<br/>
-<br/>
-<p>
-Lazy loading of Message Strings
-
-<pre class="prettyprint">
-	public class MessagesTestBundle extends NLS {
-	
-	  private static final String BUNDLE_NAME = MessagesTestBundle.class.getName();
-	
-	  private MessagesTestBundle() {
-	    // should never be instantiated
-	  }
-	
-	  static {
-	    // register all string ids with NLS class and initialize static string
-	    // values
-	    NLS.initializeMessages(BUNDLE_NAME, MessagesTestBundle.class);
-	  }
-	
-	  // static string must match the strings in the property files.
-	  public static String Q0001E_INVALID_SYNTAX;
-	  public static String Q0004E_INVALID_SYNTAX_ESCAPE_UNICODE_TRUNCATION;
-	
-	  // this message is missing from the properties file
-	  public static String Q0005E_MESSAGE_NOT_IN_BUNDLE;
-	}
-
-    // Create a message reference
-    Message invalidSyntax = new MessageImpl(MessagesTestBundle.Q0001E_INVALID_SYNTAX, "XXX");
-    
-    // Do other stuff in the code...
-    // when is time to display the message to the user or log the message on a file
-    // the message is loaded from the correct bundle
-    
-    String message1 = invalidSyntax.getLocalizedMessage();
-    String message2 = invalidSyntax.getLocalizedMessage(Locale.JAPANESE);
-</pre>
-</p>
-
-<br/>
-<br/>
-<p>
-Normal loading of Message Strings
-
-<pre class="prettyprint">
-	String message1 = NLS.getLocalizedMessage(MessagesTestBundle.Q0004E_INVALID_SYNTAX_ESCAPE_UNICODE_TRUNCATION);
-	String message2 = NLS.getLocalizedMessage(MessagesTestBundle.Q0004E_INVALID_SYNTAX_ESCAPE_UNICODE_TRUNCATION, Locale.JAPANESE);
-</pre>
-</p>
-
-<p>
-The org.apache.lucene.messages.TestNLS junit contains several other examples.
-The TestNLS java code is available from the Apache Lucene code repository.
-</p>
-</body>
-</html>
diff --git a/lucene/src/test/org/apache/lucene/messages/MessagesTestBundle.java b/lucene/src/test/org/apache/lucene/messages/MessagesTestBundle.java
deleted file mode 100644
index d12b6d5..0000000
--- a/lucene/src/test/org/apache/lucene/messages/MessagesTestBundle.java
+++ /dev/null
@@ -1,40 +0,0 @@
-package org.apache.lucene.messages;
-
-/**
- * Licensed to the Apache Software Foundation (ASF) under one or more
- * contributor license agreements. See the NOTICE file distributed with this
- * work for additional information regarding copyright ownership. The ASF
- * licenses this file to You under the Apache License, Version 2.0 (the
- * "License"); you may not use this file except in compliance with the License.
- * You may obtain a copy of the License at
- * 
- * http://www.apache.org/licenses/LICENSE-2.0
- * 
- * Unless required by applicable law or agreed to in writing, software
- * distributed under the License is distributed on an "AS IS" BASIS, WITHOUT
- * WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied. See the
- * License for the specific language governing permissions and limitations under
- * the License.
- */
-
-public class MessagesTestBundle extends NLS {
-
-  private static final String BUNDLE_NAME = MessagesTestBundle.class.getName();
-
-  private MessagesTestBundle() {
-    // should never be instantiated
-  }
-
-  static {
-    // register all string ids with NLS class and initialize static string
-    // values
-    NLS.initializeMessages(BUNDLE_NAME, MessagesTestBundle.class);
-  }
-
-  // static string must match the strings in the property files.
-  public static String Q0001E_INVALID_SYNTAX;
-  public static String Q0004E_INVALID_SYNTAX_ESCAPE_UNICODE_TRUNCATION;
-
-  // this message is missing from the properties file
-  public static String Q0005E_MESSAGE_NOT_IN_BUNDLE;
-}
diff --git a/lucene/src/test/org/apache/lucene/messages/MessagesTestBundle.properties b/lucene/src/test/org/apache/lucene/messages/MessagesTestBundle.properties
deleted file mode 100644
index 870ff73..0000000
--- a/lucene/src/test/org/apache/lucene/messages/MessagesTestBundle.properties
+++ /dev/null
@@ -1,3 +0,0 @@
-Q0001E_INVALID_SYNTAX = Syntax Error: {0}
-
-Q0004E_INVALID_SYNTAX_ESCAPE_UNICODE_TRUNCATION = Truncated unicode escape sequence.
diff --git a/lucene/src/test/org/apache/lucene/messages/MessagesTestBundle_ja.properties b/lucene/src/test/org/apache/lucene/messages/MessagesTestBundle_ja.properties
deleted file mode 100644
index 2235294..0000000
--- a/lucene/src/test/org/apache/lucene/messages/MessagesTestBundle_ja.properties
+++ /dev/null
@@ -1,3 +0,0 @@
-Q0001E_INVALID_SYNTAX = \u69cb\u6587\u30a8\u30e9\u30fc: {0}
-
-Q0004E_INVALID_SYNTAX_ESCAPE_UNICODE_TRUNCATION = \u5207\u308a\u6368\u3066\u3089\u308c\u305f\u30e6\u30cb\u30b3\u30fc\u30c9\u30fb\u30a8\u30b9\u30b1\u30fc\u30d7\u30fb\u30b7\u30fc\u30b1\u30f3\u30b9\u3002
diff --git a/lucene/src/test/org/apache/lucene/messages/TestNLS.java b/lucene/src/test/org/apache/lucene/messages/TestNLS.java
deleted file mode 100644
index c9ea9c1..0000000
--- a/lucene/src/test/org/apache/lucene/messages/TestNLS.java
+++ /dev/null
@@ -1,106 +0,0 @@
-package org.apache.lucene.messages;
-
-/**
- * Licensed to the Apache Software Foundation (ASF) under one or more
- * contributor license agreements.  See the NOTICE file distributed with
- * this work for additional information regarding copyright ownership.
- * The ASF licenses this file to You under the Apache License, Version 2.0
- * (the "License"); you may not use this file except in compliance with
- * the License.  You may obtain a copy of the License at
- *
- *     http://www.apache.org/licenses/LICENSE-2.0
- *
- * Unless required by applicable law or agreed to in writing, software
- * distributed under the License is distributed on an "AS IS" BASIS,
- * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
- * See the License for the specific language governing permissions and
- * limitations under the License.
- */
-
-import java.util.Locale;
-
-import org.apache.lucene.util.LuceneTestCase;
-
-/**
- */
-public class TestNLS extends LuceneTestCase {
-  public void testMessageLoading() {
-    Message invalidSyntax = new MessageImpl(
-        MessagesTestBundle.Q0001E_INVALID_SYNTAX, "XXX");
-    /* 
-     * if the default locale is ja, you get ja as a fallback:
-     * see ResourceBundle.html#getBundle(java.lang.String, java.util.Locale, java.lang.ClassLoader)
-     */
-    if (!Locale.getDefault().getLanguage().equals("ja"))
-      assertEquals("Syntax Error: XXX", invalidSyntax.getLocalizedMessage(Locale.ENGLISH));
-  }
-
-  public void testMessageLoading_ja() {
-    Message invalidSyntax = new MessageImpl(
-        MessagesTestBundle.Q0001E_INVALID_SYNTAX, "XXX");
-    assertEquals("æ§???¨ã???: XXX", invalidSyntax
-        .getLocalizedMessage(Locale.JAPANESE));
-  }
-
-  public void testNLSLoading() {
-    String message = NLS
-        .getLocalizedMessage(MessagesTestBundle.Q0004E_INVALID_SYNTAX_ESCAPE_UNICODE_TRUNCATION, Locale.ENGLISH);
-    /* 
-     * if the default locale is ja, you get ja as a fallback:
-     * see ResourceBundle.html#getBundle(java.lang.String, java.util.Locale, java.lang.ClassLoader)
-     */
-    if (!Locale.getDefault().getLanguage().equals("ja"))
-      assertEquals("Truncated unicode escape sequence.", message);
-
-    message = NLS.getLocalizedMessage(MessagesTestBundle.Q0001E_INVALID_SYNTAX, Locale.ENGLISH,
-        "XXX");
-    /* 
-     * if the default locale is ja, you get ja as a fallback:
-     * see ResourceBundle.html#getBundle(java.lang.String, java.util.Locale, java.lang.ClassLoader)
-     */
-    if (!Locale.getDefault().getLanguage().equals("ja"))
-      assertEquals("Syntax Error: XXX", message);
-  }
-
-  public void testNLSLoading_ja() {
-    String message = NLS.getLocalizedMessage(
-        MessagesTestBundle.Q0004E_INVALID_SYNTAX_ESCAPE_UNICODE_TRUNCATION,
-        Locale.JAPANESE);
-    assertEquals("????¨ã???????????¼ã??»ã??¹ã??¼ã??»ã??¼ã??³ã???", message);
-
-    message = NLS.getLocalizedMessage(MessagesTestBundle.Q0001E_INVALID_SYNTAX,
-        Locale.JAPANESE, "XXX");
-    assertEquals("æ§???¨ã???: XXX", message);
-  }
-
-  public void testNLSLoading_xx_XX() {
-    Locale locale = new Locale("xx", "XX", "");
-    String message = NLS.getLocalizedMessage(
-        MessagesTestBundle.Q0004E_INVALID_SYNTAX_ESCAPE_UNICODE_TRUNCATION,
-        locale);
-    /* 
-     * if the default locale is ja, you get ja as a fallback:
-     * see ResourceBundle.html#getBundle(java.lang.String, java.util.Locale, java.lang.ClassLoader)
-     */
-    if (!Locale.getDefault().getLanguage().equals("ja"))
-      assertEquals("Truncated unicode escape sequence.", message);
-
-    message = NLS.getLocalizedMessage(MessagesTestBundle.Q0001E_INVALID_SYNTAX,
-        locale, "XXX");
-    /* 
-     * if the default locale is ja, you get ja as a fallback:
-     * see ResourceBundle.html#getBundle(java.lang.String, java.util.Locale, java.lang.ClassLoader)
-     */
-    if (!Locale.getDefault().getLanguage().equals("ja"))
-      assertEquals("Syntax Error: XXX", message);
-  }
-
-  public void testMissingMessage() {
-    Locale locale = Locale.ENGLISH;
-    String message = NLS.getLocalizedMessage(
-        MessagesTestBundle.Q0005E_MESSAGE_NOT_IN_BUNDLE, locale);
-
-    assertEquals("Message with key:Q0005E_MESSAGE_NOT_IN_BUNDLE and locale: "
-        + locale.toString() + " not found.", message);
-  }
-}
diff --git a/modules/queryparser/build.xml b/modules/queryparser/build.xml
index 4987f37..9087b66 100644
--- a/modules/queryparser/build.xml
+++ b/modules/queryparser/build.xml
@@ -90,8 +90,8 @@
                              match="package org.apache.lucene.queryparser.flexible.standard.parser;"
                              replace="package org.apache.lucene.queryparser.flexible.standard.parser;${line.separator}
 ${line.separator}
-import org.apache.lucene.messages.Message;${line.separator}
-import org.apache.lucene.messages.MessageImpl;${line.separator}
+import org.apache.lucene.queryparser.flexible.messages.Message;${line.separator}
+import org.apache.lucene.queryparser.flexible.messages.MessageImpl;${line.separator}
 import org.apache.lucene.queryparser.flexible.core.*;${line.separator}
 import org.apache.lucene.queryparser.flexible.core.messages.*;"
                              flags="g"
diff --git a/modules/queryparser/src/java/org/apache/lucene/queryparser/flexible/core/QueryNodeError.java b/modules/queryparser/src/java/org/apache/lucene/queryparser/flexible/core/QueryNodeError.java
index 636567f..da66b5c 100644
--- a/modules/queryparser/src/java/org/apache/lucene/queryparser/flexible/core/QueryNodeError.java
+++ b/modules/queryparser/src/java/org/apache/lucene/queryparser/flexible/core/QueryNodeError.java
@@ -17,8 +17,8 @@ package org.apache.lucene.queryparser.flexible.core;
  * limitations under the License.
  */
 
-import org.apache.lucene.messages.Message;
-import org.apache.lucene.messages.NLSException;
+import org.apache.lucene.queryparser.flexible.messages.Message;
+import org.apache.lucene.queryparser.flexible.messages.NLSException;
 
 /**
  * Error class with NLS support
diff --git a/modules/queryparser/src/java/org/apache/lucene/queryparser/flexible/core/QueryNodeException.java b/modules/queryparser/src/java/org/apache/lucene/queryparser/flexible/core/QueryNodeException.java
index 2e7ceec..c2f3779 100644
--- a/modules/queryparser/src/java/org/apache/lucene/queryparser/flexible/core/QueryNodeException.java
+++ b/modules/queryparser/src/java/org/apache/lucene/queryparser/flexible/core/QueryNodeException.java
@@ -19,10 +19,10 @@ package org.apache.lucene.queryparser.flexible.core;
 
 import java.util.Locale;
 
-import org.apache.lucene.messages.Message;
-import org.apache.lucene.messages.MessageImpl;
-import org.apache.lucene.messages.NLS;
-import org.apache.lucene.messages.NLSException;
+import org.apache.lucene.queryparser.flexible.messages.Message;
+import org.apache.lucene.queryparser.flexible.messages.MessageImpl;
+import org.apache.lucene.queryparser.flexible.messages.NLS;
+import org.apache.lucene.queryparser.flexible.messages.NLSException;
 import org.apache.lucene.queryparser.flexible.core.messages.QueryParserMessages;
 import org.apache.lucene.queryparser.flexible.core.nodes.QueryNode;
 
diff --git a/modules/queryparser/src/java/org/apache/lucene/queryparser/flexible/core/QueryNodeParseException.java b/modules/queryparser/src/java/org/apache/lucene/queryparser/flexible/core/QueryNodeParseException.java
index 24c8e2a..b309ec3 100644
--- a/modules/queryparser/src/java/org/apache/lucene/queryparser/flexible/core/QueryNodeParseException.java
+++ b/modules/queryparser/src/java/org/apache/lucene/queryparser/flexible/core/QueryNodeParseException.java
@@ -17,8 +17,8 @@ package org.apache.lucene.queryparser.flexible.core;
  * limitations under the License.
  */
 
-import org.apache.lucene.messages.Message;
-import org.apache.lucene.messages.MessageImpl;
+import org.apache.lucene.queryparser.flexible.messages.Message;
+import org.apache.lucene.queryparser.flexible.messages.MessageImpl;
 import org.apache.lucene.queryparser.flexible.core.messages.QueryParserMessages;
 import org.apache.lucene.queryparser.flexible.core.parser.SyntaxParser;
 import org.apache.lucene.queryparser.flexible.core.nodes.QueryNode;
diff --git a/modules/queryparser/src/java/org/apache/lucene/queryparser/flexible/core/builders/QueryTreeBuilder.java b/modules/queryparser/src/java/org/apache/lucene/queryparser/flexible/core/builders/QueryTreeBuilder.java
index f557a29..f77bc96 100644
--- a/modules/queryparser/src/java/org/apache/lucene/queryparser/flexible/core/builders/QueryTreeBuilder.java
+++ b/modules/queryparser/src/java/org/apache/lucene/queryparser/flexible/core/builders/QueryTreeBuilder.java
@@ -20,7 +20,7 @@ package org.apache.lucene.queryparser.flexible.core.builders;
 import java.util.HashMap;
 import java.util.List;
 
-import org.apache.lucene.messages.MessageImpl;
+import org.apache.lucene.queryparser.flexible.messages.MessageImpl;
 import org.apache.lucene.queryparser.flexible.core.QueryNodeException;
 import org.apache.lucene.queryparser.flexible.core.messages.QueryParserMessages;
 import org.apache.lucene.queryparser.flexible.core.nodes.FieldableNode;
diff --git a/modules/queryparser/src/java/org/apache/lucene/queryparser/flexible/core/messages/QueryParserMessages.java b/modules/queryparser/src/java/org/apache/lucene/queryparser/flexible/core/messages/QueryParserMessages.java
index 82f0e1e..757f4f6 100644
--- a/modules/queryparser/src/java/org/apache/lucene/queryparser/flexible/core/messages/QueryParserMessages.java
+++ b/modules/queryparser/src/java/org/apache/lucene/queryparser/flexible/core/messages/QueryParserMessages.java
@@ -17,7 +17,7 @@ package org.apache.lucene.queryparser.flexible.core.messages;
  * limitations under the License.
  */
 
-import org.apache.lucene.messages.NLS;
+import org.apache.lucene.queryparser.flexible.messages.NLS;
 
 /**
  * Flexible Query Parser message bundle class
diff --git a/modules/queryparser/src/java/org/apache/lucene/queryparser/flexible/core/nodes/BoostQueryNode.java b/modules/queryparser/src/java/org/apache/lucene/queryparser/flexible/core/nodes/BoostQueryNode.java
index eb0bc62..4da96fa 100644
--- a/modules/queryparser/src/java/org/apache/lucene/queryparser/flexible/core/nodes/BoostQueryNode.java
+++ b/modules/queryparser/src/java/org/apache/lucene/queryparser/flexible/core/nodes/BoostQueryNode.java
@@ -19,7 +19,7 @@ package org.apache.lucene.queryparser.flexible.core.nodes;
 
 import java.util.List;
 
-import org.apache.lucene.messages.MessageImpl;
+import org.apache.lucene.queryparser.flexible.messages.MessageImpl;
 import org.apache.lucene.queryparser.flexible.core.QueryNodeError;
 import org.apache.lucene.queryparser.flexible.core.QueryNodeException;
 import org.apache.lucene.queryparser.flexible.core.messages.QueryParserMessages;
diff --git a/modules/queryparser/src/java/org/apache/lucene/queryparser/flexible/core/nodes/GroupQueryNode.java b/modules/queryparser/src/java/org/apache/lucene/queryparser/flexible/core/nodes/GroupQueryNode.java
index eef1963..e4fcc0c 100644
--- a/modules/queryparser/src/java/org/apache/lucene/queryparser/flexible/core/nodes/GroupQueryNode.java
+++ b/modules/queryparser/src/java/org/apache/lucene/queryparser/flexible/core/nodes/GroupQueryNode.java
@@ -20,7 +20,7 @@ package org.apache.lucene.queryparser.flexible.core.nodes;
 import java.util.ArrayList;
 import java.util.List;
 
-import org.apache.lucene.messages.MessageImpl;
+import org.apache.lucene.queryparser.flexible.messages.MessageImpl;
 import org.apache.lucene.queryparser.flexible.core.QueryNodeError;
 import org.apache.lucene.queryparser.flexible.core.messages.QueryParserMessages;
 import org.apache.lucene.queryparser.flexible.core.parser.EscapeQuerySyntax;
diff --git a/modules/queryparser/src/java/org/apache/lucene/queryparser/flexible/core/nodes/ModifierQueryNode.java b/modules/queryparser/src/java/org/apache/lucene/queryparser/flexible/core/nodes/ModifierQueryNode.java
index c6747ac..f092ee9 100644
--- a/modules/queryparser/src/java/org/apache/lucene/queryparser/flexible/core/nodes/ModifierQueryNode.java
+++ b/modules/queryparser/src/java/org/apache/lucene/queryparser/flexible/core/nodes/ModifierQueryNode.java
@@ -20,7 +20,7 @@ package org.apache.lucene.queryparser.flexible.core.nodes;
 import java.util.ArrayList;
 import java.util.List;
 
-import org.apache.lucene.messages.MessageImpl;
+import org.apache.lucene.queryparser.flexible.messages.MessageImpl;
 import org.apache.lucene.queryparser.flexible.core.parser.EscapeQuerySyntax;
 import org.apache.lucene.queryparser.flexible.core.QueryNodeError;
 import org.apache.lucene.queryparser.flexible.core.messages.QueryParserMessages;
diff --git a/modules/queryparser/src/java/org/apache/lucene/queryparser/flexible/core/nodes/PhraseSlopQueryNode.java b/modules/queryparser/src/java/org/apache/lucene/queryparser/flexible/core/nodes/PhraseSlopQueryNode.java
index 1751139..c4c592a 100644
--- a/modules/queryparser/src/java/org/apache/lucene/queryparser/flexible/core/nodes/PhraseSlopQueryNode.java
+++ b/modules/queryparser/src/java/org/apache/lucene/queryparser/flexible/core/nodes/PhraseSlopQueryNode.java
@@ -17,7 +17,7 @@ package org.apache.lucene.queryparser.flexible.core.nodes;
  * limitations under the License.
  */
 
-import org.apache.lucene.messages.MessageImpl;
+import org.apache.lucene.queryparser.flexible.messages.MessageImpl;
 import org.apache.lucene.queryparser.flexible.core.QueryNodeError;
 import org.apache.lucene.queryparser.flexible.core.QueryNodeException;
 import org.apache.lucene.queryparser.flexible.core.messages.QueryParserMessages;
diff --git a/modules/queryparser/src/java/org/apache/lucene/queryparser/flexible/core/nodes/ProximityQueryNode.java b/modules/queryparser/src/java/org/apache/lucene/queryparser/flexible/core/nodes/ProximityQueryNode.java
index 9929d94..75d1ca3 100644
--- a/modules/queryparser/src/java/org/apache/lucene/queryparser/flexible/core/nodes/ProximityQueryNode.java
+++ b/modules/queryparser/src/java/org/apache/lucene/queryparser/flexible/core/nodes/ProximityQueryNode.java
@@ -19,7 +19,7 @@ package org.apache.lucene.queryparser.flexible.core.nodes;
 
 import java.util.List;
 
-import org.apache.lucene.messages.MessageImpl;
+import org.apache.lucene.queryparser.flexible.messages.MessageImpl;
 import org.apache.lucene.queryparser.flexible.core.parser.EscapeQuerySyntax;
 import org.apache.lucene.queryparser.flexible.core.QueryNodeError;
 import org.apache.lucene.queryparser.flexible.core.messages.QueryParserMessages;
diff --git a/modules/queryparser/src/java/org/apache/lucene/queryparser/flexible/core/nodes/QueryNodeImpl.java b/modules/queryparser/src/java/org/apache/lucene/queryparser/flexible/core/nodes/QueryNodeImpl.java
index fba4bdc..1be7957 100644
--- a/modules/queryparser/src/java/org/apache/lucene/queryparser/flexible/core/nodes/QueryNodeImpl.java
+++ b/modules/queryparser/src/java/org/apache/lucene/queryparser/flexible/core/nodes/QueryNodeImpl.java
@@ -23,7 +23,7 @@ import java.util.List;
 import java.util.Map;
 import java.util.ResourceBundle;
 
-import org.apache.lucene.messages.NLS;
+import org.apache.lucene.queryparser.flexible.messages.NLS;
 import org.apache.lucene.queryparser.flexible.core.messages.QueryParserMessages;
 import org.apache.lucene.queryparser.flexible.core.util.StringUtils;
 
diff --git a/modules/queryparser/src/java/org/apache/lucene/queryparser/flexible/core/nodes/SlopQueryNode.java b/modules/queryparser/src/java/org/apache/lucene/queryparser/flexible/core/nodes/SlopQueryNode.java
index e47912b..a29ef75 100644
--- a/modules/queryparser/src/java/org/apache/lucene/queryparser/flexible/core/nodes/SlopQueryNode.java
+++ b/modules/queryparser/src/java/org/apache/lucene/queryparser/flexible/core/nodes/SlopQueryNode.java
@@ -17,7 +17,7 @@ package org.apache.lucene.queryparser.flexible.core.nodes;
  * limitations under the License.
  */
 
-import org.apache.lucene.messages.MessageImpl;
+import org.apache.lucene.queryparser.flexible.messages.MessageImpl;
 import org.apache.lucene.queryparser.flexible.core.parser.EscapeQuerySyntax;
 import org.apache.lucene.queryparser.flexible.core.QueryNodeError;
 import org.apache.lucene.queryparser.flexible.core.messages.QueryParserMessages;
diff --git a/modules/queryparser/src/java/org/apache/lucene/queryparser/flexible/messages/Message.java b/modules/queryparser/src/java/org/apache/lucene/queryparser/flexible/messages/Message.java
new file mode 100644
index 0000000..9422913
--- /dev/null
+++ b/modules/queryparser/src/java/org/apache/lucene/queryparser/flexible/messages/Message.java
@@ -0,0 +1,36 @@
+package org.apache.lucene.queryparser.flexible.messages;
+
+/**
+ * Licensed to the Apache Software Foundation (ASF) under one or more
+ * contributor license agreements.  See the NOTICE file distributed with
+ * this work for additional information regarding copyright ownership.
+ * The ASF licenses this file to You under the Apache License, Version 2.0
+ * (the "License"); you may not use this file except in compliance with
+ * the License.  You may obtain a copy of the License at
+ *
+ *     http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ */
+
+import java.util.Locale;
+
+/**
+ * Message Interface for a lazy loading.
+ * For Native Language Support (NLS), system of software internationalization.
+ */
+public interface Message {
+
+  public String getKey();
+
+  public Object[] getArguments();
+
+  public String getLocalizedMessage();
+
+  public String getLocalizedMessage(Locale locale);
+
+}
diff --git a/modules/queryparser/src/java/org/apache/lucene/queryparser/flexible/messages/MessageImpl.java b/modules/queryparser/src/java/org/apache/lucene/queryparser/flexible/messages/MessageImpl.java
new file mode 100644
index 0000000..e056f62
--- /dev/null
+++ b/modules/queryparser/src/java/org/apache/lucene/queryparser/flexible/messages/MessageImpl.java
@@ -0,0 +1,70 @@
+package org.apache.lucene.queryparser.flexible.messages;
+
+/**
+ * Licensed to the Apache Software Foundation (ASF) under one or more
+ * contributor license agreements.  See the NOTICE file distributed with
+ * this work for additional information regarding copyright ownership.
+ * The ASF licenses this file to You under the Apache License, Version 2.0
+ * (the "License"); you may not use this file except in compliance with
+ * the License.  You may obtain a copy of the License at
+ *
+ *     http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ */
+
+import java.util.Locale;
+
+/**
+ * Default implementation of Message interface.
+ * For Native Language Support (NLS), system of software internationalization.
+ */
+public class MessageImpl implements Message {
+
+  private String key;
+
+  private Object[] arguments = new Object[0];
+
+  public MessageImpl(String key) {
+    this.key = key;
+
+  }
+
+  public MessageImpl(String key, Object... args) {
+    this(key);
+    this.arguments = args;
+  }
+
+  public Object[] getArguments() {
+    return this.arguments;
+  }
+
+  public String getKey() {
+    return this.key;
+  }
+
+  public String getLocalizedMessage() {
+    return getLocalizedMessage(Locale.getDefault());
+  }
+
+  public String getLocalizedMessage(Locale locale) {
+    return NLS.getLocalizedMessage(getKey(), locale, getArguments());
+  }
+
+  @Override
+  public String toString() {
+    Object[] args = getArguments();
+    StringBuilder sb = new StringBuilder(getKey());
+    if (args != null) {
+      for (int i = 0; i < args.length; i++) {
+        sb.append(i == 0 ? " " : ", ").append(args[i]);
+      }
+    }
+    return sb.toString();
+  }
+
+}
diff --git a/modules/queryparser/src/java/org/apache/lucene/queryparser/flexible/messages/NLS.java b/modules/queryparser/src/java/org/apache/lucene/queryparser/flexible/messages/NLS.java
new file mode 100644
index 0000000..ad2b627
--- /dev/null
+++ b/modules/queryparser/src/java/org/apache/lucene/queryparser/flexible/messages/NLS.java
@@ -0,0 +1,206 @@
+package org.apache.lucene.queryparser.flexible.messages;
+
+/**
+ * Licensed to the Apache Software Foundation (ASF) under one or more
+ * contributor license agreements.  See the NOTICE file distributed with
+ * this work for additional information regarding copyright ownership.
+ * The ASF licenses this file to You under the Apache License, Version 2.0
+ * (the "License"); you may not use this file except in compliance with
+ * the License.  You may obtain a copy of the License at
+ *
+ *     http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ */
+
+import java.lang.reflect.Field;
+import java.lang.reflect.Modifier;
+import java.security.AccessController;
+import java.security.PrivilegedAction;
+import java.text.MessageFormat;
+import java.util.HashMap;
+import java.util.Iterator;
+import java.util.Locale;
+import java.util.Map;
+import java.util.MissingResourceException;
+import java.util.ResourceBundle;
+
+/**
+ * MessageBundles classes extend this class, to implement a bundle.
+ * 
+ * For Native Language Support (NLS), system of software internationalization.
+ * 
+ * This interface is similar to the NLS class in eclipse.osgi.util.NLS class -
+ * initializeMessages() method resets the values of all static strings, should
+ * only be called by classes that extend from NLS (see TestMessages.java for
+ * reference) - performs validation of all message in a bundle, at class load
+ * time - performs per message validation at runtime - see NLSTest.java for
+ * usage reference
+ * 
+ * MessageBundle classes may subclass this type.
+ */
+public class NLS {
+
+  private static Map<String, Class<? extends NLS>> bundles = 
+    new HashMap<String, Class<? extends NLS>>(0);
+
+  protected NLS() {
+    // Do not instantiate
+  }
+
+  public static String getLocalizedMessage(String key) {
+    return getLocalizedMessage(key, Locale.getDefault());
+  }
+
+  public static String getLocalizedMessage(String key, Locale locale) {
+    Object message = getResourceBundleObject(key, locale);
+    if (message == null) {
+      return "Message with key:" + key + " and locale: " + locale
+          + " not found.";
+    }
+    return message.toString();
+  }
+
+  public static String getLocalizedMessage(String key, Locale locale,
+      Object... args) {
+    String str = getLocalizedMessage(key, locale);
+
+    if (args.length > 0) {
+      str = MessageFormat.format(str, args);
+    }
+
+    return str;
+  }
+
+  public static String getLocalizedMessage(String key, Object... args) {
+    return getLocalizedMessage(key, Locale.getDefault(), args);
+  }
+
+  /**
+   * Initialize a given class with the message bundle Keys Should be called from
+   * a class that extends NLS in a static block at class load time.
+   * 
+   * @param bundleName
+   *          Property file with that contains the message bundle
+   * @param clazz
+   *          where constants will reside
+   */
+  protected static void initializeMessages(String bundleName, Class<? extends NLS> clazz) {
+    try {
+      load(clazz);
+      if (!bundles.containsKey(bundleName))
+        bundles.put(bundleName, clazz);
+    } catch (Throwable e) {
+      // ignore all errors and exceptions
+      // because this function is supposed to be called at class load time.
+    }
+  }
+
+  private static Object getResourceBundleObject(String messageKey, Locale locale) {
+
+    // slow resource checking
+    // need to loop thru all registered resource bundles
+    for (Iterator<String> it = bundles.keySet().iterator(); it.hasNext();) {
+      Class<? extends NLS> clazz = bundles.get(it.next());
+      ResourceBundle resourceBundle = ResourceBundle.getBundle(clazz.getName(),
+          locale);
+      if (resourceBundle != null) {
+        try {
+          Object obj = resourceBundle.getObject(messageKey);
+          if (obj != null)
+            return obj;
+        } catch (MissingResourceException e) {
+          // just continue it might be on the next resource bundle
+        }
+      }
+    }
+    // if resource is not found
+    return null;
+  }
+
+  /**
+   * @param clazz
+   */
+  private static void load(Class<? extends NLS> clazz) {
+    final Field[] fieldArray = clazz.getDeclaredFields();
+
+    boolean isFieldAccessible = (clazz.getModifiers() & Modifier.PUBLIC) != 0;
+
+    // build a map of field names to Field objects
+    final int len = fieldArray.length;
+    Map<String, Field> fields = new HashMap<String, Field>(len * 2);
+    for (int i = 0; i < len; i++) {
+      fields.put(fieldArray[i].getName(), fieldArray[i]);
+      loadfieldValue(fieldArray[i], isFieldAccessible, clazz);
+    }
+  }
+
+  /**
+   * @param field
+   * @param isFieldAccessible
+   */
+  private static void loadfieldValue(Field field, boolean isFieldAccessible,
+      Class<? extends NLS> clazz) {
+    int MOD_EXPECTED = Modifier.PUBLIC | Modifier.STATIC;
+    int MOD_MASK = MOD_EXPECTED | Modifier.FINAL;
+    if ((field.getModifiers() & MOD_MASK) != MOD_EXPECTED)
+      return;
+
+    // Set a value for this empty field.
+    if (!isFieldAccessible)
+      makeAccessible(field);
+    try {
+      field.set(null, field.getName());
+      validateMessage(field.getName(), clazz);
+    } catch (IllegalArgumentException e) {
+      // should not happen
+    } catch (IllegalAccessException e) {
+      // should not happen
+    }
+  }
+
+  /**
+   * @param key
+   *          - Message Key
+   */
+  private static void validateMessage(String key, Class<? extends NLS> clazz) {
+    // Test if the message is present in the resource bundle
+    try {
+      ResourceBundle resourceBundle = ResourceBundle.getBundle(clazz.getName(),
+          Locale.getDefault());
+      if (resourceBundle != null) {
+        Object obj = resourceBundle.getObject(key);
+        if (obj == null)
+          System.err.println("WARN: Message with key:" + key + " and locale: "
+              + Locale.getDefault() + " not found.");
+      }
+    } catch (MissingResourceException e) {
+      System.err.println("WARN: Message with key:" + key + " and locale: "
+          + Locale.getDefault() + " not found.");
+    } catch (Throwable e) {
+      // ignore all other errors and exceptions
+      // since this code is just a test to see if the message is present on the
+      // system
+    }
+  }
+
+  /*
+   * Make a class field accessible
+   */
+  private static void makeAccessible(final Field field) {
+    if (System.getSecurityManager() == null) {
+      field.setAccessible(true);
+    } else {
+      AccessController.doPrivileged(new PrivilegedAction<Void>() {
+        public Void run() {
+          field.setAccessible(true);
+          return null;
+        }
+      });
+    }
+  }
+}
diff --git a/modules/queryparser/src/java/org/apache/lucene/queryparser/flexible/messages/NLSException.java b/modules/queryparser/src/java/org/apache/lucene/queryparser/flexible/messages/NLSException.java
new file mode 100644
index 0000000..0e7a1e9
--- /dev/null
+++ b/modules/queryparser/src/java/org/apache/lucene/queryparser/flexible/messages/NLSException.java
@@ -0,0 +1,34 @@
+package org.apache.lucene.queryparser.flexible.messages;
+
+/**
+ * Licensed to the Apache Software Foundation (ASF) under one or more
+ * contributor license agreements.  See the NOTICE file distributed with
+ * this work for additional information regarding copyright ownership.
+ * The ASF licenses this file to You under the Apache License, Version 2.0
+ * (the "License"); you may not use this file except in compliance with
+ * the License.  You may obtain a copy of the License at
+ *
+ *     http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ */
+
+/**
+ * Interface that exceptions should implement to support lazy loading of messages.
+ * 
+ * For Native Language Support (NLS), system of software internationalization.
+ * 
+ * This Interface should be implemented by all exceptions that require
+ * translation
+ * 
+ */
+public interface NLSException {
+  /**
+   * @return a instance of a class that implements the Message interface
+   */
+  public Message getMessageObject();
+}
diff --git a/modules/queryparser/src/java/org/apache/lucene/queryparser/flexible/messages/package.html b/modules/queryparser/src/java/org/apache/lucene/queryparser/flexible/messages/package.html
new file mode 100644
index 0000000..24d4171
--- /dev/null
+++ b/modules/queryparser/src/java/org/apache/lucene/queryparser/flexible/messages/package.html
@@ -0,0 +1,99 @@
+<!doctype html public "-//w3c//dtd html 4.0 transitional//en">
+<!--
+ Licensed to the Apache Software Foundation (ASF) under one or more
+ contributor license agreements.  See the NOTICE file distributed with
+ this work for additional information regarding copyright ownership.
+ The ASF licenses this file to You under the Apache License, Version 2.0
+ (the "License"); you may not use this file except in compliance with
+ the License.  You may obtain a copy of the License at
+
+     http://www.apache.org/licenses/LICENSE-2.0
+
+ Unless required by applicable law or agreed to in writing, software
+ distributed under the License is distributed on an "AS IS" BASIS,
+ WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ See the License for the specific language governing permissions and
+ limitations under the License.
+-->
+<html>
+<head>
+   <meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
+</head>
+<body>
+
+For Native Language Support (NLS), system of software internationalization.
+
+<h2>NLS message API</h2>
+<p>
+This utility API, adds support for NLS messages in the apache code.
+It is currently used by the lucene "New Flexible Query PArser".
+</p>
+<p>
+Features:
+    <ol>
+        <li>Message reference in the code, using static Strings</li>
+        <li>Message resource validation at class load time, for easier debugging</li>
+        <li>Allows for message IDs to be re-factored using eclipse or other code re-factor tools</li>
+        <li>Allows for reference count on messages, just like code</li>
+		<li>Lazy loading of Message Strings</li>        
+        <li>Normal loading Message Strings</li>                  
+    </ol>
+</p>
+
+<br/>
+<br/>
+<p>
+Lazy loading of Message Strings
+
+<pre class="prettyprint">
+	public class MessagesTestBundle extends NLS {
+	
+	  private static final String BUNDLE_NAME = MessagesTestBundle.class.getName();
+	
+	  private MessagesTestBundle() {
+	    // should never be instantiated
+	  }
+	
+	  static {
+	    // register all string ids with NLS class and initialize static string
+	    // values
+	    NLS.initializeMessages(BUNDLE_NAME, MessagesTestBundle.class);
+	  }
+	
+	  // static string must match the strings in the property files.
+	  public static String Q0001E_INVALID_SYNTAX;
+	  public static String Q0004E_INVALID_SYNTAX_ESCAPE_UNICODE_TRUNCATION;
+	
+	  // this message is missing from the properties file
+	  public static String Q0005E_MESSAGE_NOT_IN_BUNDLE;
+	}
+
+    // Create a message reference
+    Message invalidSyntax = new MessageImpl(MessagesTestBundle.Q0001E_INVALID_SYNTAX, "XXX");
+    
+    // Do other stuff in the code...
+    // when is time to display the message to the user or log the message on a file
+    // the message is loaded from the correct bundle
+    
+    String message1 = invalidSyntax.getLocalizedMessage();
+    String message2 = invalidSyntax.getLocalizedMessage(Locale.JAPANESE);
+</pre>
+</p>
+
+<br/>
+<br/>
+<p>
+Normal loading of Message Strings
+
+<pre class="prettyprint">
+	String message1 = NLS.getLocalizedMessage(MessagesTestBundle.Q0004E_INVALID_SYNTAX_ESCAPE_UNICODE_TRUNCATION);
+	String message2 = NLS.getLocalizedMessage(MessagesTestBundle.Q0004E_INVALID_SYNTAX_ESCAPE_UNICODE_TRUNCATION, Locale.JAPANESE);
+</pre>
+</p>
+
+<p>
+The org.apache.lucene.messages.TestNLS junit contains several other examples.
+The TestNLS java code is available from the Apache Lucene code repository.
+</p>
+</body>
+</html>
diff --git a/modules/queryparser/src/java/org/apache/lucene/queryparser/flexible/standard/builders/AnyQueryNodeBuilder.java b/modules/queryparser/src/java/org/apache/lucene/queryparser/flexible/standard/builders/AnyQueryNodeBuilder.java
index 1c08ea8..e07ab11 100644
--- a/modules/queryparser/src/java/org/apache/lucene/queryparser/flexible/standard/builders/AnyQueryNodeBuilder.java
+++ b/modules/queryparser/src/java/org/apache/lucene/queryparser/flexible/standard/builders/AnyQueryNodeBuilder.java
@@ -19,7 +19,7 @@ package org.apache.lucene.queryparser.flexible.standard.builders;
 
 import java.util.List;
 
-import org.apache.lucene.messages.MessageImpl;
+import org.apache.lucene.queryparser.flexible.messages.MessageImpl;
 import org.apache.lucene.queryparser.flexible.core.QueryNodeException;
 import org.apache.lucene.queryparser.flexible.core.builders.QueryTreeBuilder;
 import org.apache.lucene.queryparser.flexible.core.messages.QueryParserMessages;
diff --git a/modules/queryparser/src/java/org/apache/lucene/queryparser/flexible/standard/builders/BooleanQueryNodeBuilder.java b/modules/queryparser/src/java/org/apache/lucene/queryparser/flexible/standard/builders/BooleanQueryNodeBuilder.java
index e3a419f..d5435e9 100644
--- a/modules/queryparser/src/java/org/apache/lucene/queryparser/flexible/standard/builders/BooleanQueryNodeBuilder.java
+++ b/modules/queryparser/src/java/org/apache/lucene/queryparser/flexible/standard/builders/BooleanQueryNodeBuilder.java
@@ -19,7 +19,7 @@ package org.apache.lucene.queryparser.flexible.standard.builders;
 
 import java.util.List;
 
-import org.apache.lucene.messages.MessageImpl;
+import org.apache.lucene.queryparser.flexible.messages.MessageImpl;
 import org.apache.lucene.queryparser.flexible.core.QueryNodeException;
 import org.apache.lucene.queryparser.flexible.core.builders.QueryTreeBuilder;
 import org.apache.lucene.queryparser.flexible.core.messages.QueryParserMessages;
diff --git a/modules/queryparser/src/java/org/apache/lucene/queryparser/flexible/standard/builders/MatchAllDocsQueryNodeBuilder.java b/modules/queryparser/src/java/org/apache/lucene/queryparser/flexible/standard/builders/MatchAllDocsQueryNodeBuilder.java
index 733728f..4c9b3e3 100644
--- a/modules/queryparser/src/java/org/apache/lucene/queryparser/flexible/standard/builders/MatchAllDocsQueryNodeBuilder.java
+++ b/modules/queryparser/src/java/org/apache/lucene/queryparser/flexible/standard/builders/MatchAllDocsQueryNodeBuilder.java
@@ -17,7 +17,7 @@ package org.apache.lucene.queryparser.flexible.standard.builders;
  * limitations under the License.
  */
 
-import org.apache.lucene.messages.MessageImpl;
+import org.apache.lucene.queryparser.flexible.messages.MessageImpl;
 import org.apache.lucene.queryparser.flexible.core.QueryNodeException;
 import org.apache.lucene.queryparser.flexible.core.messages.QueryParserMessages;
 import org.apache.lucene.queryparser.flexible.core.nodes.MatchAllDocsQueryNode;
diff --git a/modules/queryparser/src/java/org/apache/lucene/queryparser/flexible/standard/builders/MatchNoDocsQueryNodeBuilder.java b/modules/queryparser/src/java/org/apache/lucene/queryparser/flexible/standard/builders/MatchNoDocsQueryNodeBuilder.java
index 903c6fc..0a33f75 100644
--- a/modules/queryparser/src/java/org/apache/lucene/queryparser/flexible/standard/builders/MatchNoDocsQueryNodeBuilder.java
+++ b/modules/queryparser/src/java/org/apache/lucene/queryparser/flexible/standard/builders/MatchNoDocsQueryNodeBuilder.java
@@ -17,7 +17,7 @@ package org.apache.lucene.queryparser.flexible.standard.builders;
  * limitations under the License.
  */
 
-import org.apache.lucene.messages.MessageImpl;
+import org.apache.lucene.queryparser.flexible.messages.MessageImpl;
 import org.apache.lucene.queryparser.flexible.core.QueryNodeException;
 import org.apache.lucene.queryparser.flexible.core.messages.QueryParserMessages;
 import org.apache.lucene.queryparser.flexible.core.nodes.MatchNoDocsQueryNode;
diff --git a/modules/queryparser/src/java/org/apache/lucene/queryparser/flexible/standard/builders/NumericRangeQueryNodeBuilder.java b/modules/queryparser/src/java/org/apache/lucene/queryparser/flexible/standard/builders/NumericRangeQueryNodeBuilder.java
index edd8e59..f6d03e9 100644
--- a/modules/queryparser/src/java/org/apache/lucene/queryparser/flexible/standard/builders/NumericRangeQueryNodeBuilder.java
+++ b/modules/queryparser/src/java/org/apache/lucene/queryparser/flexible/standard/builders/NumericRangeQueryNodeBuilder.java
@@ -18,7 +18,7 @@ package org.apache.lucene.queryparser.flexible.standard.builders;
  */
 
 import org.apache.lucene.document.NumericField;
-import org.apache.lucene.messages.MessageImpl;
+import org.apache.lucene.queryparser.flexible.messages.MessageImpl;
 import org.apache.lucene.queryparser.flexible.core.QueryNodeException;
 import org.apache.lucene.queryparser.flexible.core.messages.QueryParserMessages;
 import org.apache.lucene.queryparser.flexible.core.nodes.QueryNode;
diff --git a/modules/queryparser/src/java/org/apache/lucene/queryparser/flexible/standard/builders/StandardBooleanQueryNodeBuilder.java b/modules/queryparser/src/java/org/apache/lucene/queryparser/flexible/standard/builders/StandardBooleanQueryNodeBuilder.java
index 5a4b09e..860c5c1 100644
--- a/modules/queryparser/src/java/org/apache/lucene/queryparser/flexible/standard/builders/StandardBooleanQueryNodeBuilder.java
+++ b/modules/queryparser/src/java/org/apache/lucene/queryparser/flexible/standard/builders/StandardBooleanQueryNodeBuilder.java
@@ -19,7 +19,7 @@ package org.apache.lucene.queryparser.flexible.standard.builders;
 
 import java.util.List;
 
-import org.apache.lucene.messages.MessageImpl;
+import org.apache.lucene.queryparser.flexible.messages.MessageImpl;
 import org.apache.lucene.queryparser.flexible.core.QueryNodeException;
 import org.apache.lucene.queryparser.flexible.core.builders.QueryTreeBuilder;
 import org.apache.lucene.queryparser.flexible.core.messages.QueryParserMessages;
diff --git a/modules/queryparser/src/java/org/apache/lucene/queryparser/flexible/standard/nodes/NumericRangeQueryNode.java b/modules/queryparser/src/java/org/apache/lucene/queryparser/flexible/standard/nodes/NumericRangeQueryNode.java
index 9910ad3..a5aa937 100644
--- a/modules/queryparser/src/java/org/apache/lucene/queryparser/flexible/standard/nodes/NumericRangeQueryNode.java
+++ b/modules/queryparser/src/java/org/apache/lucene/queryparser/flexible/standard/nodes/NumericRangeQueryNode.java
@@ -1,7 +1,7 @@
 package org.apache.lucene.queryparser.flexible.standard.nodes;
 
 import org.apache.lucene.document.NumericField;
-import org.apache.lucene.messages.MessageImpl;
+import org.apache.lucene.queryparser.flexible.messages.MessageImpl;
 import org.apache.lucene.queryparser.flexible.core.QueryNodeException;
 import org.apache.lucene.queryparser.flexible.core.messages.QueryParserMessages;
 import org.apache.lucene.queryparser.flexible.core.nodes.FieldQueryNode;
diff --git a/modules/queryparser/src/java/org/apache/lucene/queryparser/flexible/standard/parser/EscapeQuerySyntaxImpl.java b/modules/queryparser/src/java/org/apache/lucene/queryparser/flexible/standard/parser/EscapeQuerySyntaxImpl.java
index f581f14..0e8742e 100644
--- a/modules/queryparser/src/java/org/apache/lucene/queryparser/flexible/standard/parser/EscapeQuerySyntaxImpl.java
+++ b/modules/queryparser/src/java/org/apache/lucene/queryparser/flexible/standard/parser/EscapeQuerySyntaxImpl.java
@@ -19,7 +19,7 @@ package org.apache.lucene.queryparser.flexible.standard.parser;
 
 import java.util.Locale;
 
-import org.apache.lucene.messages.MessageImpl;
+import org.apache.lucene.queryparser.flexible.messages.MessageImpl;
 import org.apache.lucene.queryparser.flexible.core.messages.QueryParserMessages;
 import org.apache.lucene.queryparser.flexible.core.parser.EscapeQuerySyntax;
 import org.apache.lucene.queryparser.flexible.core.util.UnescapedCharSequence;
diff --git a/modules/queryparser/src/java/org/apache/lucene/queryparser/flexible/standard/parser/JavaCharStream.java b/modules/queryparser/src/java/org/apache/lucene/queryparser/flexible/standard/parser/JavaCharStream.java
index 27dc146..59bd8f5 100644
--- a/modules/queryparser/src/java/org/apache/lucene/queryparser/flexible/standard/parser/JavaCharStream.java
+++ b/modules/queryparser/src/java/org/apache/lucene/queryparser/flexible/standard/parser/JavaCharStream.java
@@ -613,4 +613,4 @@ public class JavaCharStream
   }
 
 }
-/* JavaCC - OriginalChecksum=7eecaeeaea1254b3e35fe8890a0127ce (do not edit this line) */
+/* JavaCC - OriginalChecksum=a050c1d21b27b6d9eed401dd428aa609 (do not edit this line) */
diff --git a/modules/queryparser/src/java/org/apache/lucene/queryparser/flexible/standard/parser/ParseException.java b/modules/queryparser/src/java/org/apache/lucene/queryparser/flexible/standard/parser/ParseException.java
index 48b1a4d..8b1badb 100644
--- a/modules/queryparser/src/java/org/apache/lucene/queryparser/flexible/standard/parser/ParseException.java
+++ b/modules/queryparser/src/java/org/apache/lucene/queryparser/flexible/standard/parser/ParseException.java
@@ -2,8 +2,8 @@
 /* JavaCCOptions:KEEP_LINE_COL=null */
 package org.apache.lucene.queryparser.flexible.standard.parser;
  
- import org.apache.lucene.messages.Message;
- import org.apache.lucene.messages.MessageImpl;
+ import org.apache.lucene.queryparser.flexible.messages.Message;
+ import org.apache.lucene.queryparser.flexible.messages.MessageImpl;
  import org.apache.lucene.queryparser.flexible.core.*;
  import org.apache.lucene.queryparser.flexible.core.messages.*;
 
@@ -193,4 +193,4 @@ public class ParseException extends QueryNodeParseException {
    }
 
 }
-/* JavaCC - OriginalChecksum=0f25f4245374bbf9920c9a82efecadd2 (do not edit this line) */
+/* JavaCC - OriginalChecksum=7601d49d11bc059457ae5850628ebc8a (do not edit this line) */
diff --git a/modules/queryparser/src/java/org/apache/lucene/queryparser/flexible/standard/parser/StandardSyntaxParser.java b/modules/queryparser/src/java/org/apache/lucene/queryparser/flexible/standard/parser/StandardSyntaxParser.java
index c5c5c8a..37e71c3 100644
--- a/modules/queryparser/src/java/org/apache/lucene/queryparser/flexible/standard/parser/StandardSyntaxParser.java
+++ b/modules/queryparser/src/java/org/apache/lucene/queryparser/flexible/standard/parser/StandardSyntaxParser.java
@@ -21,8 +21,8 @@ package org.apache.lucene.queryparser.flexible.standard.parser;
 import java.io.StringReader;
 import java.util.Vector;
 
-import org.apache.lucene.messages.Message;
-import org.apache.lucene.messages.MessageImpl;
+import org.apache.lucene.queryparser.flexible.messages.Message;
+import org.apache.lucene.queryparser.flexible.messages.MessageImpl;
 import org.apache.lucene.queryparser.flexible.core.QueryNodeParseException;
 import org.apache.lucene.queryparser.flexible.core.messages.QueryParserMessages;
 import org.apache.lucene.queryparser.flexible.core.nodes.AndQueryNode;
diff --git a/modules/queryparser/src/java/org/apache/lucene/queryparser/flexible/standard/parser/StandardSyntaxParser.jj b/modules/queryparser/src/java/org/apache/lucene/queryparser/flexible/standard/parser/StandardSyntaxParser.jj
index c9744a5..31435b9 100644
--- a/modules/queryparser/src/java/org/apache/lucene/queryparser/flexible/standard/parser/StandardSyntaxParser.jj
+++ b/modules/queryparser/src/java/org/apache/lucene/queryparser/flexible/standard/parser/StandardSyntaxParser.jj
@@ -33,8 +33,8 @@ package org.apache.lucene.queryparser.flexible.standard.parser;
 import java.io.StringReader;
 import java.util.Vector;
 
-import org.apache.lucene.messages.Message;
-import org.apache.lucene.messages.MessageImpl;
+import org.apache.lucene.queryparser.flexible.messages.Message;
+import org.apache.lucene.queryparser.flexible.messages.MessageImpl;
 import org.apache.lucene.queryparser.flexible.core.QueryNodeParseException;
 import org.apache.lucene.queryparser.flexible.core.messages.QueryParserMessages;
 import org.apache.lucene.queryparser.flexible.core.nodes.AndQueryNode;
diff --git a/modules/queryparser/src/java/org/apache/lucene/queryparser/flexible/standard/parser/StandardSyntaxParserTokenManager.java b/modules/queryparser/src/java/org/apache/lucene/queryparser/flexible/standard/parser/StandardSyntaxParserTokenManager.java
index 1fa8ee5..aaa1aa7 100644
--- a/modules/queryparser/src/java/org/apache/lucene/queryparser/flexible/standard/parser/StandardSyntaxParserTokenManager.java
+++ b/modules/queryparser/src/java/org/apache/lucene/queryparser/flexible/standard/parser/StandardSyntaxParserTokenManager.java
@@ -19,8 +19,8 @@ package org.apache.lucene.queryparser.flexible.standard.parser;
 
 import java.io.StringReader;
 import java.util.Vector;
-import org.apache.lucene.messages.Message;
-import org.apache.lucene.messages.MessageImpl;
+import org.apache.lucene.queryparser.flexible.messages.Message;
+import org.apache.lucene.queryparser.flexible.messages.MessageImpl;
 import org.apache.lucene.queryparser.flexible.core.QueryNodeParseException;
 import org.apache.lucene.queryparser.flexible.core.messages.QueryParserMessages;
 import org.apache.lucene.queryparser.flexible.core.nodes.AndQueryNode;
diff --git a/modules/queryparser/src/java/org/apache/lucene/queryparser/flexible/standard/parser/Token.java b/modules/queryparser/src/java/org/apache/lucene/queryparser/flexible/standard/parser/Token.java
index e005731..95869f3 100644
--- a/modules/queryparser/src/java/org/apache/lucene/queryparser/flexible/standard/parser/Token.java
+++ b/modules/queryparser/src/java/org/apache/lucene/queryparser/flexible/standard/parser/Token.java
@@ -121,4 +121,4 @@ public class Token {
   }
 
 }
-/* JavaCC - OriginalChecksum=e9c55091ec11152bcd3a300ddff5c73a (do not edit this line) */
+/* JavaCC - OriginalChecksum=3b4fe6dcfcfa24a81f1c6ceffae5f73a (do not edit this line) */
diff --git a/modules/queryparser/src/java/org/apache/lucene/queryparser/flexible/standard/parser/TokenMgrError.java b/modules/queryparser/src/java/org/apache/lucene/queryparser/flexible/standard/parser/TokenMgrError.java
index c0c63c7..24647e1 100644
--- a/modules/queryparser/src/java/org/apache/lucene/queryparser/flexible/standard/parser/TokenMgrError.java
+++ b/modules/queryparser/src/java/org/apache/lucene/queryparser/flexible/standard/parser/TokenMgrError.java
@@ -138,4 +138,4 @@ public class TokenMgrError extends Error
       this(LexicalError(EOFSeen, lexState, errorLine, errorColumn, errorAfter, curChar), reason);
    }
 }
-/* JavaCC - OriginalChecksum=76b513fd9c50f65248056bbeeff49277 (do not edit this line) */
+/* JavaCC - OriginalChecksum=1efb3d906925f2478637c66473b79bae (do not edit this line) */
diff --git a/modules/queryparser/src/java/org/apache/lucene/queryparser/flexible/standard/processors/AllowLeadingWildcardProcessor.java b/modules/queryparser/src/java/org/apache/lucene/queryparser/flexible/standard/processors/AllowLeadingWildcardProcessor.java
index 1b3e0b5..830b494 100644
--- a/modules/queryparser/src/java/org/apache/lucene/queryparser/flexible/standard/processors/AllowLeadingWildcardProcessor.java
+++ b/modules/queryparser/src/java/org/apache/lucene/queryparser/flexible/standard/processors/AllowLeadingWildcardProcessor.java
@@ -19,7 +19,7 @@ package org.apache.lucene.queryparser.flexible.standard.processors;
 
 import java.util.List;
 
-import org.apache.lucene.messages.MessageImpl;
+import org.apache.lucene.queryparser.flexible.messages.MessageImpl;
 import org.apache.lucene.queryparser.flexible.core.QueryNodeException;
 import org.apache.lucene.queryparser.flexible.core.config.QueryConfigHandler;
 import org.apache.lucene.queryparser.flexible.core.messages.QueryParserMessages;
diff --git a/modules/queryparser/src/java/org/apache/lucene/queryparser/flexible/standard/processors/NumericQueryNodeProcessor.java b/modules/queryparser/src/java/org/apache/lucene/queryparser/flexible/standard/processors/NumericQueryNodeProcessor.java
index d1114c6..efea5482 100644
--- a/modules/queryparser/src/java/org/apache/lucene/queryparser/flexible/standard/processors/NumericQueryNodeProcessor.java
+++ b/modules/queryparser/src/java/org/apache/lucene/queryparser/flexible/standard/processors/NumericQueryNodeProcessor.java
@@ -21,7 +21,7 @@ import java.text.NumberFormat;
 import java.text.ParseException;
 import java.util.List;
 
-import org.apache.lucene.messages.MessageImpl;
+import org.apache.lucene.queryparser.flexible.messages.MessageImpl;
 import org.apache.lucene.queryparser.flexible.core.QueryNodeException;
 import org.apache.lucene.queryparser.flexible.core.QueryNodeParseException;
 import org.apache.lucene.queryparser.flexible.core.config.FieldConfig;
diff --git a/modules/queryparser/src/java/org/apache/lucene/queryparser/flexible/standard/processors/NumericRangeQueryNodeProcessor.java b/modules/queryparser/src/java/org/apache/lucene/queryparser/flexible/standard/processors/NumericRangeQueryNodeProcessor.java
index fde9449..4fdb2b3 100644
--- a/modules/queryparser/src/java/org/apache/lucene/queryparser/flexible/standard/processors/NumericRangeQueryNodeProcessor.java
+++ b/modules/queryparser/src/java/org/apache/lucene/queryparser/flexible/standard/processors/NumericRangeQueryNodeProcessor.java
@@ -21,7 +21,7 @@ import java.text.NumberFormat;
 import java.text.ParseException;
 import java.util.List;
 
-import org.apache.lucene.messages.MessageImpl;
+import org.apache.lucene.queryparser.flexible.messages.MessageImpl;
 import org.apache.lucene.queryparser.flexible.core.QueryNodeException;
 import org.apache.lucene.queryparser.flexible.core.QueryNodeParseException;
 import org.apache.lucene.queryparser.flexible.core.config.FieldConfig;
diff --git a/modules/queryparser/src/test/org/apache/lucene/queryparser/flexible/messages/MessagesTestBundle.java b/modules/queryparser/src/test/org/apache/lucene/queryparser/flexible/messages/MessagesTestBundle.java
new file mode 100644
index 0000000..e56f4e9
--- /dev/null
+++ b/modules/queryparser/src/test/org/apache/lucene/queryparser/flexible/messages/MessagesTestBundle.java
@@ -0,0 +1,40 @@
+package org.apache.lucene.queryparser.flexible.messages;
+
+/**
+ * Licensed to the Apache Software Foundation (ASF) under one or more
+ * contributor license agreements. See the NOTICE file distributed with this
+ * work for additional information regarding copyright ownership. The ASF
+ * licenses this file to You under the Apache License, Version 2.0 (the
+ * "License"); you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ * 
+ * http://www.apache.org/licenses/LICENSE-2.0
+ * 
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS, WITHOUT
+ * WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied. See the
+ * License for the specific language governing permissions and limitations under
+ * the License.
+ */
+
+public class MessagesTestBundle extends NLS {
+
+  private static final String BUNDLE_NAME = MessagesTestBundle.class.getName();
+
+  private MessagesTestBundle() {
+    // should never be instantiated
+  }
+
+  static {
+    // register all string ids with NLS class and initialize static string
+    // values
+    NLS.initializeMessages(BUNDLE_NAME, MessagesTestBundle.class);
+  }
+
+  // static string must match the strings in the property files.
+  public static String Q0001E_INVALID_SYNTAX;
+  public static String Q0004E_INVALID_SYNTAX_ESCAPE_UNICODE_TRUNCATION;
+
+  // this message is missing from the properties file
+  public static String Q0005E_MESSAGE_NOT_IN_BUNDLE;
+}
diff --git a/modules/queryparser/src/test/org/apache/lucene/queryparser/flexible/messages/MessagesTestBundle.properties b/modules/queryparser/src/test/org/apache/lucene/queryparser/flexible/messages/MessagesTestBundle.properties
new file mode 100644
index 0000000..870ff73
--- /dev/null
+++ b/modules/queryparser/src/test/org/apache/lucene/queryparser/flexible/messages/MessagesTestBundle.properties
@@ -0,0 +1,3 @@
+Q0001E_INVALID_SYNTAX = Syntax Error: {0}
+
+Q0004E_INVALID_SYNTAX_ESCAPE_UNICODE_TRUNCATION = Truncated unicode escape sequence.
diff --git a/modules/queryparser/src/test/org/apache/lucene/queryparser/flexible/messages/MessagesTestBundle_ja.properties b/modules/queryparser/src/test/org/apache/lucene/queryparser/flexible/messages/MessagesTestBundle_ja.properties
new file mode 100644
index 0000000..2235294
--- /dev/null
+++ b/modules/queryparser/src/test/org/apache/lucene/queryparser/flexible/messages/MessagesTestBundle_ja.properties
@@ -0,0 +1,3 @@
+Q0001E_INVALID_SYNTAX = \u69cb\u6587\u30a8\u30e9\u30fc: {0}
+
+Q0004E_INVALID_SYNTAX_ESCAPE_UNICODE_TRUNCATION = \u5207\u308a\u6368\u3066\u3089\u308c\u305f\u30e6\u30cb\u30b3\u30fc\u30c9\u30fb\u30a8\u30b9\u30b1\u30fc\u30d7\u30fb\u30b7\u30fc\u30b1\u30f3\u30b9\u3002
diff --git a/modules/queryparser/src/test/org/apache/lucene/queryparser/flexible/messages/TestNLS.java b/modules/queryparser/src/test/org/apache/lucene/queryparser/flexible/messages/TestNLS.java
new file mode 100644
index 0000000..7cf4d9a
--- /dev/null
+++ b/modules/queryparser/src/test/org/apache/lucene/queryparser/flexible/messages/TestNLS.java
@@ -0,0 +1,106 @@
+package org.apache.lucene.queryparser.flexible.messages;
+
+/**
+ * Licensed to the Apache Software Foundation (ASF) under one or more
+ * contributor license agreements.  See the NOTICE file distributed with
+ * this work for additional information regarding copyright ownership.
+ * The ASF licenses this file to You under the Apache License, Version 2.0
+ * (the "License"); you may not use this file except in compliance with
+ * the License.  You may obtain a copy of the License at
+ *
+ *     http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ */
+
+import java.util.Locale;
+
+import org.apache.lucene.util.LuceneTestCase;
+
+/**
+ */
+public class TestNLS extends LuceneTestCase {
+  public void testMessageLoading() {
+    Message invalidSyntax = new MessageImpl(
+        MessagesTestBundle.Q0001E_INVALID_SYNTAX, "XXX");
+    /* 
+     * if the default locale is ja, you get ja as a fallback:
+     * see ResourceBundle.html#getBundle(java.lang.String, java.util.Locale, java.lang.ClassLoader)
+     */
+    if (!Locale.getDefault().getLanguage().equals("ja"))
+      assertEquals("Syntax Error: XXX", invalidSyntax.getLocalizedMessage(Locale.ENGLISH));
+  }
+
+  public void testMessageLoading_ja() {
+    Message invalidSyntax = new MessageImpl(
+        MessagesTestBundle.Q0001E_INVALID_SYNTAX, "XXX");
+    assertEquals("æ§???¨ã???: XXX", invalidSyntax
+        .getLocalizedMessage(Locale.JAPANESE));
+  }
+
+  public void testNLSLoading() {
+    String message = NLS
+        .getLocalizedMessage(MessagesTestBundle.Q0004E_INVALID_SYNTAX_ESCAPE_UNICODE_TRUNCATION, Locale.ENGLISH);
+    /* 
+     * if the default locale is ja, you get ja as a fallback:
+     * see ResourceBundle.html#getBundle(java.lang.String, java.util.Locale, java.lang.ClassLoader)
+     */
+    if (!Locale.getDefault().getLanguage().equals("ja"))
+      assertEquals("Truncated unicode escape sequence.", message);
+
+    message = NLS.getLocalizedMessage(MessagesTestBundle.Q0001E_INVALID_SYNTAX, Locale.ENGLISH,
+        "XXX");
+    /* 
+     * if the default locale is ja, you get ja as a fallback:
+     * see ResourceBundle.html#getBundle(java.lang.String, java.util.Locale, java.lang.ClassLoader)
+     */
+    if (!Locale.getDefault().getLanguage().equals("ja"))
+      assertEquals("Syntax Error: XXX", message);
+  }
+
+  public void testNLSLoading_ja() {
+    String message = NLS.getLocalizedMessage(
+        MessagesTestBundle.Q0004E_INVALID_SYNTAX_ESCAPE_UNICODE_TRUNCATION,
+        Locale.JAPANESE);
+    assertEquals("????¨ã???????????¼ã??»ã??¹ã??¼ã??»ã??¼ã??³ã???", message);
+
+    message = NLS.getLocalizedMessage(MessagesTestBundle.Q0001E_INVALID_SYNTAX,
+        Locale.JAPANESE, "XXX");
+    assertEquals("æ§???¨ã???: XXX", message);
+  }
+
+  public void testNLSLoading_xx_XX() {
+    Locale locale = new Locale("xx", "XX", "");
+    String message = NLS.getLocalizedMessage(
+        MessagesTestBundle.Q0004E_INVALID_SYNTAX_ESCAPE_UNICODE_TRUNCATION,
+        locale);
+    /* 
+     * if the default locale is ja, you get ja as a fallback:
+     * see ResourceBundle.html#getBundle(java.lang.String, java.util.Locale, java.lang.ClassLoader)
+     */
+    if (!Locale.getDefault().getLanguage().equals("ja"))
+      assertEquals("Truncated unicode escape sequence.", message);
+
+    message = NLS.getLocalizedMessage(MessagesTestBundle.Q0001E_INVALID_SYNTAX,
+        locale, "XXX");
+    /* 
+     * if the default locale is ja, you get ja as a fallback:
+     * see ResourceBundle.html#getBundle(java.lang.String, java.util.Locale, java.lang.ClassLoader)
+     */
+    if (!Locale.getDefault().getLanguage().equals("ja"))
+      assertEquals("Syntax Error: XXX", message);
+  }
+
+  public void testMissingMessage() {
+    Locale locale = Locale.ENGLISH;
+    String message = NLS.getLocalizedMessage(
+        MessagesTestBundle.Q0005E_MESSAGE_NOT_IN_BUNDLE, locale);
+
+    assertEquals("Message with key:Q0005E_MESSAGE_NOT_IN_BUNDLE and locale: "
+        + locale.toString() + " not found.", message);
+  }
+}
diff --git a/modules/queryparser/src/test/org/apache/lucene/queryparser/flexible/spans/SpansValidatorQueryNodeProcessor.java b/modules/queryparser/src/test/org/apache/lucene/queryparser/flexible/spans/SpansValidatorQueryNodeProcessor.java
index 3ebc306..965aaa7 100644
--- a/modules/queryparser/src/test/org/apache/lucene/queryparser/flexible/spans/SpansValidatorQueryNodeProcessor.java
+++ b/modules/queryparser/src/test/org/apache/lucene/queryparser/flexible/spans/SpansValidatorQueryNodeProcessor.java
@@ -19,7 +19,7 @@ package org.apache.lucene.queryparser.flexible.spans;
 
 import java.util.List;
 
-import org.apache.lucene.messages.MessageImpl;
+import org.apache.lucene.queryparser.flexible.messages.MessageImpl;
 import org.apache.lucene.queryparser.flexible.core.QueryNodeException;
 import org.apache.lucene.queryparser.flexible.core.messages.QueryParserMessages;
 import org.apache.lucene.queryparser.flexible.core.nodes.AndQueryNode;
diff --git a/modules/queryparser/src/test/org/apache/lucene/queryparser/flexible/standard/TestQPHelper.java b/modules/queryparser/src/test/org/apache/lucene/queryparser/flexible/standard/TestQPHelper.java
index 03ad2c3..70f8266 100644
--- a/modules/queryparser/src/test/org/apache/lucene/queryparser/flexible/standard/TestQPHelper.java
+++ b/modules/queryparser/src/test/org/apache/lucene/queryparser/flexible/standard/TestQPHelper.java
@@ -38,7 +38,7 @@ import org.apache.lucene.document.TextField;
 import org.apache.lucene.index.IndexWriter;
 import org.apache.lucene.index.IndexReader;
 import org.apache.lucene.index.Term;
-import org.apache.lucene.messages.MessageImpl;
+import org.apache.lucene.queryparser.flexible.messages.MessageImpl;
 import org.apache.lucene.queryparser.flexible.core.QueryNodeException;
 import org.apache.lucene.queryparser.flexible.core.messages.QueryParserMessages;
 import org.apache.lucene.queryparser.flexible.core.nodes.FuzzyQueryNode;

