GitDiffStart: 8f550126f745f7c01e6129c2ca860978d76db07f | Wed Jan 25 14:18:06 2012 +0000
diff --git a/dev-tools/eclipse/dot.classpath b/dev-tools/eclipse/dot.classpath
index f95959a..0e901c1 100644
--- a/dev-tools/eclipse/dot.classpath
+++ b/dev-tools/eclipse/dot.classpath
@@ -96,7 +96,7 @@
 	<classpathentry kind="lib" path="modules/analysis/morfologik/lib/morfologik-stemming-1.5.2.jar"/>
 	<classpathentry kind="lib" path="modules/benchmark/lib/commons-beanutils-1.7.0.jar"/>
 	<classpathentry kind="lib" path="modules/benchmark/lib/commons-collections-3.1.jar"/>
-	<classpathentry kind="lib" path="modules/benchmark/lib/commons-compress-1.2.jar"/>
+	<classpathentry kind="lib" path="modules/benchmark/lib/commons-compress-1.3.jar"/>
 	<classpathentry kind="lib" path="modules/benchmark/lib/commons-digester-1.7.jar"/>
 	<classpathentry kind="lib" path="modules/benchmark/lib/commons-logging-1.0.4.jar"/>
 	<classpathentry kind="lib" path="modules/benchmark/lib/xercesImpl-2.9.1-patched-XERCESJ-1257.jar"/>
@@ -149,8 +149,8 @@
 	<classpathentry kind="lib" path="solr/contrib/extraction/lib/poi-scratchpad-3.8-beta4.jar"/>
 	<classpathentry kind="lib" path="solr/contrib/extraction/lib/rome-0.9.jar"/>
 	<classpathentry kind="lib" path="solr/contrib/extraction/lib/tagsoup-1.2.1.jar"/>
-	<classpathentry kind="lib" path="solr/contrib/extraction/lib/tika-core-0.10.jar"/>
-	<classpathentry kind="lib" path="solr/contrib/extraction/lib/tika-parsers-0.10.jar"/>
+	<classpathentry kind="lib" path="solr/contrib/extraction/lib/tika-core-1.0.jar"/>
+	<classpathentry kind="lib" path="solr/contrib/extraction/lib/tika-parsers-1.0.jar"/>
 	<classpathentry kind="lib" path="solr/contrib/extraction/lib/xmlbeans-2.3.0.jar"/>
 	<classpathentry kind="lib" path="solr/contrib/langid/lib/langdetect-r111.jar"/>
 	<classpathentry kind="lib" path="solr/contrib/langid/lib/jsonic-1.2.0.jar"/>
diff --git a/dev-tools/maven/pom.xml.template b/dev-tools/maven/pom.xml.template
index c1f3a0f..5c62f5f 100644
--- a/dev-tools/maven/pom.xml.template
+++ b/dev-tools/maven/pom.xml.template
@@ -45,7 +45,7 @@
     <jetty.version>6.1.26</jetty.version>
     <patched.jetty.version>6.1.26-patched-JETTY-1340</patched.jetty.version>
     <slf4j.version>1.6.1</slf4j.version>
-    <tika.version>0.10</tika.version>
+    <tika.version>1.0</tika.version>
   </properties>
   <issueManagement>
     <system>JIRA</system>
diff --git a/solr/CHANGES.txt b/solr/CHANGES.txt
index 997b79e..0ef90c7 100644
--- a/solr/CHANGES.txt
+++ b/solr/CHANGES.txt
@@ -24,7 +24,7 @@ $Id$
 ==================  4.0.0-dev ==================
 Versions of Major Components
 ---------------------
-Apache Tika 0.10
+Apache Tika 1.0
 Carrot2 3.5.0
 Velocity 1.6.4 and Velocity Tools 2.0
 Apache UIMA 2.3.1
@@ -556,6 +556,8 @@ Other Changes
 * SOLR-2718: Add ability to lazy load response writers, defined with startup="lazy".
   (ehatcher)
 
+* SOLR-2901: Upgrade Solr to Tika 1.0 (janhoy)
+
 Build
 ----------------------
 * SOLR-2487: Add build target to package war without slf4j jars (janhoy)
diff --git a/solr/contrib/dataimporthandler-extras/src/java/org/apache/solr/handler/dataimport/MailEntityProcessor.java b/solr/contrib/dataimporthandler-extras/src/java/org/apache/solr/handler/dataimport/MailEntityProcessor.java
index 8b4e673..b4d8231 100644
--- a/solr/contrib/dataimporthandler-extras/src/java/org/apache/solr/handler/dataimport/MailEntityProcessor.java
+++ b/solr/contrib/dataimporthandler-extras/src/java/org/apache/solr/handler/dataimport/MailEntityProcessor.java
@@ -18,8 +18,8 @@ package org.apache.solr.handler.dataimport;
 
 import com.sun.mail.imap.IMAPMessage;
 
-import org.apache.tika.config.TikaConfig;
-import org.apache.tika.utils.ParseUtils;
+import org.apache.tika.Tika;
+import org.apache.tika.metadata.Metadata;
 import org.slf4j.Logger;
 import org.slf4j.LoggerFactory;
 
@@ -95,6 +95,8 @@ public class MailEntityProcessor extends EntityProcessorBase {
               getStringFromContext("processAttachment",null) == null ? "processAttachement":"processAttachment"
             , true);
 
+    tika = new Tika();
+    
     logConfig();
   }
 
@@ -166,7 +168,10 @@ public class MailEntityProcessor extends EntityProcessorBase {
       if (!processAttachment || (disp != null && disp.equalsIgnoreCase(Part.ATTACHMENT)))        return;
       InputStream is = part.getInputStream();
       String fileName = part.getFileName();
-      String content = ParseUtils.getStringContent(is, TikaConfig.getDefaultConfig(), ctype.getBaseType().toLowerCase(Locale.ENGLISH));
+      Metadata md = new Metadata();
+      md.set(Metadata.CONTENT_TYPE, ctype.getBaseType().toLowerCase(Locale.ENGLISH));
+      md.set(Metadata.RESOURCE_NAME_KEY, fileName);
+      String content = tika.parseToString(is, md);
       if (disp != null && disp.equalsIgnoreCase(Part.ATTACHMENT)) {
         if (row.get(ATTACHMENT) == null)
           row.put(ATTACHMENT, new ArrayList<String>());
@@ -529,6 +534,8 @@ public class MailEntityProcessor extends EntityProcessorBase {
 
   private boolean processAttachment = true;
 
+  private Tika tika;
+  
   // holds the current state
   private Store mailbox;
   private boolean connected = false;
diff --git a/solr/contrib/dataimporthandler-extras/src/java/org/apache/solr/handler/dataimport/TikaEntityProcessor.java b/solr/contrib/dataimporthandler-extras/src/java/org/apache/solr/handler/dataimport/TikaEntityProcessor.java
index 6d42ec4..e3dd7ae 100644
--- a/solr/contrib/dataimporthandler-extras/src/java/org/apache/solr/handler/dataimport/TikaEntityProcessor.java
+++ b/solr/contrib/dataimporthandler-extras/src/java/org/apache/solr/handler/dataimport/TikaEntityProcessor.java
@@ -118,9 +118,7 @@ public class TikaEntityProcessor extends EntityProcessorBase {
     }
     Parser tikaParser = null;
     if(parser.equals(AUTO_PARSER)){
-      AutoDetectParser parser = new AutoDetectParser();
-      parser.setConfig(tikaConfig);
-      tikaParser = parser;
+      tikaParser = new AutoDetectParser(tikaConfig);
     } else {
       tikaParser = (Parser) context.getSolrCore().getResourceLoader().newInstance(parser);
     }
diff --git a/solr/contrib/extraction/CHANGES.txt b/solr/contrib/extraction/CHANGES.txt
index daf04a7..bf81ac7 100644
--- a/solr/contrib/extraction/CHANGES.txt
+++ b/solr/contrib/extraction/CHANGES.txt
@@ -20,7 +20,7 @@ to your Solr Home lib directory.  See http://wiki.apache.org/solr/ExtractingRequ
 Tika Dependency
 ---------------
 
-Current Version: Tika 0.10 (released 2011-09-30)
+Current Version: Tika 1.0 (released 2011-11-07)
 
 $Id$
 
@@ -34,6 +34,8 @@ $Id$
   This is convenient when Tika's auto detector cannot detect encoding, especially
   the text file is too short to detect encoding. (koji)
 
+* SOLR-2901: Upgrade Solr to Tika 1.0 (janhoy)
+
 ================== Release 3.5.0 ==================
 
 * SOLR-2372: Upgrade Solr to Tika 0.10 (janhoy)
diff --git a/solr/contrib/extraction/lib/commons-compress-1.2.jar b/solr/contrib/extraction/lib/commons-compress-1.2.jar
deleted file mode 100755
index 7a6af36..0000000
--- a/solr/contrib/extraction/lib/commons-compress-1.2.jar
+++ /dev/null
@@ -1,2 +0,0 @@
-AnyObjectId[61753909c3f32306bf60d09e5345d47058ba2122] was removed in git history.
-Apache SVN contains full history.
\ No newline at end of file
diff --git a/solr/contrib/extraction/lib/commons-compress-1.3.jar b/solr/contrib/extraction/lib/commons-compress-1.3.jar
new file mode 100644
index 0000000..0a27da8
--- /dev/null
+++ b/solr/contrib/extraction/lib/commons-compress-1.3.jar
@@ -0,0 +1,2 @@
+AnyObjectId[6c826c528b60bb1b25e9053b7f4c920292f6c343] was removed in git history.
+Apache SVN contains full history.
\ No newline at end of file
diff --git a/solr/contrib/extraction/lib/tika-core-0.10.jar b/solr/contrib/extraction/lib/tika-core-0.10.jar
deleted file mode 100644
index fc3b331..0000000
--- a/solr/contrib/extraction/lib/tika-core-0.10.jar
+++ /dev/null
@@ -1,2 +0,0 @@
-AnyObjectId[2259a3b83e63f6ad14b866bff7925b2a1b9f0c23] was removed in git history.
-Apache SVN contains full history.
\ No newline at end of file
diff --git a/solr/contrib/extraction/lib/tika-core-1.0.jar b/solr/contrib/extraction/lib/tika-core-1.0.jar
new file mode 100644
index 0000000..b884eaf
--- /dev/null
+++ b/solr/contrib/extraction/lib/tika-core-1.0.jar
@@ -0,0 +1,2 @@
+AnyObjectId[5d6bc873cd8bd72dd426090f1b237f373f5fdc00] was removed in git history.
+Apache SVN contains full history.
\ No newline at end of file
diff --git a/solr/contrib/extraction/lib/tika-parsers-0.10.jar b/solr/contrib/extraction/lib/tika-parsers-0.10.jar
deleted file mode 100644
index 9392674..0000000
--- a/solr/contrib/extraction/lib/tika-parsers-0.10.jar
+++ /dev/null
@@ -1,2 +0,0 @@
-AnyObjectId[57368ebb26d4b6493e76efa5552b2e489bc09bbe] was removed in git history.
-Apache SVN contains full history.
\ No newline at end of file
diff --git a/solr/contrib/extraction/lib/tika-parsers-1.0.jar b/solr/contrib/extraction/lib/tika-parsers-1.0.jar
new file mode 100644
index 0000000..6ff300c
--- /dev/null
+++ b/solr/contrib/extraction/lib/tika-parsers-1.0.jar
@@ -0,0 +1,2 @@
+AnyObjectId[d5e5f8fa0ad29f21719ea9bc2a85c6a95cd8a205] was removed in git history.
+Apache SVN contains full history.
\ No newline at end of file
diff --git a/solr/contrib/extraction/src/java/org/apache/solr/handler/extraction/ExtractingDocumentLoader.java b/solr/contrib/extraction/src/java/org/apache/solr/handler/extraction/ExtractingDocumentLoader.java
index a731fe1..2d250da 100644
--- a/solr/contrib/extraction/src/java/org/apache/solr/handler/extraction/ExtractingDocumentLoader.java
+++ b/solr/contrib/extraction/src/java/org/apache/solr/handler/extraction/ExtractingDocumentLoader.java
@@ -39,6 +39,7 @@ import org.apache.tika.exception.TikaException;
 import org.apache.tika.metadata.Metadata;
 import org.apache.tika.mime.MediaType;
 import org.apache.tika.parser.AutoDetectParser;
+import org.apache.tika.parser.DefaultParser;
 import org.apache.tika.parser.ParseContext;
 import org.apache.tika.parser.Parser;
 import org.apache.tika.sax.XHTMLContentHandler;
@@ -138,7 +139,7 @@ public class ExtractingDocumentLoader extends ContentStreamLoader {
     if (streamType != null) {
       //Cache?  Parsers are lightweight to construct and thread-safe, so I'm told
       MediaType mt = MediaType.parse(streamType.trim().toLowerCase(Locale.ENGLISH));
-      parser = config.getParser(mt);
+      parser = new DefaultParser(config.getMediaTypeRegistry()).getParsers().get(mt);
     } else {
       parser = autoDetectParser;
     }
@@ -151,6 +152,10 @@ public class ExtractingDocumentLoader extends ContentStreamLoader {
       if (resourceName != null) {
         metadata.add(Metadata.RESOURCE_NAME_KEY, resourceName);
       }
+      // Provide stream's content type as hint for auto detection
+      if(stream.getContentType() != null) {
+        metadata.add(Metadata.CONTENT_TYPE, stream.getContentType());
+      }
 
       InputStream inputStream = null;
       try {
diff --git a/solr/contrib/extraction/src/test/org/apache/solr/handler/extraction/ExtractingRequestHandlerTest.java b/solr/contrib/extraction/src/test/org/apache/solr/handler/extraction/ExtractingRequestHandlerTest.java
index 799b51c..c7146c8 100644
--- a/solr/contrib/extraction/src/test/org/apache/solr/handler/extraction/ExtractingRequestHandlerTest.java
+++ b/solr/contrib/extraction/src/test/org/apache/solr/handler/extraction/ExtractingRequestHandlerTest.java
@@ -18,7 +18,6 @@ package org.apache.solr.handler.extraction;
 
 import java.util.ArrayList;
 import java.util.List;
-
 import org.apache.solr.SolrTestCaseJ4;
 import org.apache.solr.common.SolrException;
 import org.apache.solr.common.util.ContentStream;
@@ -419,7 +418,33 @@ public class ExtractingRequestHandlerTest extends SolrTestCaseJ4 {
     assertU(commit());
     assertQ(req("*:*"), "//result[@numFound=1]");
   }
+  
+  @Test
+  public void testWrongStreamType() throws Exception {
+    ExtractingRequestHandler handler = (ExtractingRequestHandler) h.getCore().getRequestHandler("/update/extract");
+    assertTrue("handler is null and it shouldn't be", handler != null);
+
+    try{
+      // Load plain text specifying another mime type, should fail
+      loadLocal("extraction/version_control.txt", 
+              "literal.id", "one",
+              ExtractingParams.STREAM_TYPE, "application/pdf"
+      );
+      fail("SolrException is expected because wrong parser specified for the file type");
+    }
+    catch(Exception expected){}
 
+    try{
+      // Load plain text specifying non existing mimetype, should fail
+      loadLocal("extraction/version_control.txt", 
+              "literal.id", "one",
+              ExtractingParams.STREAM_TYPE, "foo/bar"
+      );
+      fail("SolrException is expected because nonexsisting parser specified");
+    }
+    catch(Exception expected){}
+  }
+  
   SolrQueryResponse loadLocal(String filename, String... args) throws Exception {
     LocalSolrQueryRequest req = (LocalSolrQueryRequest) req(args);
     try {
diff --git a/solr/contrib/langid/src/test/org/apache/solr/update/processor/LanguageIdentifierUpdateProcessorFactoryTestCase.java b/solr/contrib/langid/src/test/org/apache/solr/update/processor/LanguageIdentifierUpdateProcessorFactoryTestCase.java
index 8d17619..fdcaf18 100644
--- a/solr/contrib/langid/src/test/org/apache/solr/update/processor/LanguageIdentifierUpdateProcessorFactoryTestCase.java
+++ b/solr/contrib/langid/src/test/org/apache/solr/update/processor/LanguageIdentifierUpdateProcessorFactoryTestCase.java
@@ -67,7 +67,7 @@ public abstract class LanguageIdentifierUpdateProcessorFactoryTestCase extends S
     assertLang("no", "id", "1no", "name", "Lucene", "subject", "Lucene er et fri/√•pen kildekode programvarebibliotek for informasjonsgjenfinning, opprinnelig utviklet i programmeringsspr√•ket Java av Doug Cutting. Lucene st√∏ttes av Apache Software Foundation og utgis under Apache-lisensen.");
     assertLang("en", "id", "2en", "name", "Lucene", "subject", "Apache Lucene is a free/open source information retrieval software library, originally created in Java by Doug Cutting. It is supported by the Apache Software Foundation and is released under the Apache Software License.");
     assertLang("sv", "id", "3sv", "name", "Maven", "subject", "Apache Maven √§r ett verktyg utvecklat av Apache Software Foundation och anv√§nds inom systemutveckling av datorprogram i programspr√•ket Java. Maven anv√§nds f√∂r att automatiskt paketera (bygga) programfilerna till en distribuerbar enhet. Maven anv√§nds inom samma omr√•de som Apache Ant men dess byggfiler √§r deklarativa till skillnad ifr√•n Ants skriptbaserade.");
-    assertLang("es", "id", "4es", "name", "Lucene", "subject", "Lucene es un API de c√≥digo abierto para recuperaci√≥n de informaci√≥n, originalmente implementada en Java por Doug Cutting. Est√° apoyado por el Apache Software Foundation y se distribuye bajo la Apache Software License. Lucene tiene versiones para otros lenguajes incluyendo Delphi, Perl, C#, C++, Python, Ruby y PHP.");
+    assertLang("es", "id", "4es", "name", "Espa√±ol", "subject", "El espa√±ol, como las otras lenguas romances, es una continuaci√≥n moderna del lat√≠n hablado (denominado lat√≠n vulgar), desde el siglo III, que tras el desmembramiento del Imperio romano fue divergiendo de las otras variantes del lat√≠n que se hablaban en las distintas provincias del antiguo Imperio, dando lugar mediante una lenta evoluci√≥n a las distintas lenguas romances. Debido a su propagaci√≥n por Am√©rica, el espa√±ol es, con diferencia, la lengua romance que ha logrado mayor difusi√≥n.");
     assertLang("un", "id", "5un", "name", "a", "subject", "b");
     assertLang("th", "id", "6th", "name", "‡∏??‡∏?∏ß‡∏≤‡∏°‡∏?∏±‡∏?∏™‡∏£‡∏£‡π?‡∏?∏∑‡∏??‡∏?∏µ‡π?", "subject", "‡∏?∏±‡∏??‡∏?∏≠‡∏•‡∏µ‡∏? ‡∏°‡∏≤‡∏£‡∏µ ‡∏?∏±‡∏??‡∏?∏≠ ‡∏?∏£‡∏±‡?‡∏?? ‡∏?∏£‡∏∑‡∏≠‡∏°‡∏±‡∏?∏£‡∏π‡?‡∏?∏±‡∏??‡∏??‡∏≤‡∏©‡∏≤‡?‡∏?∏¢‡∏ß‡?‡∏? ‡π?∏≠‡∏??‡π? ‡π??‡∏£‡?‡∏?? ‡π?‡∏??‡∏??‡∏??‡∏?∏´‡∏?∏¥‡∏??‡∏≤‡∏ß‡∏¢‡∏¥‡∏? ‡π?‡∏?∏¥‡∏??‡∏µ‡?‡π?‡∏°‡∏∑‡∏??‡π??‡∏£‡?‡∏??‡π?‡∏?∏¥‡∏£‡?‡∏? ‡∏?∏£‡∏∞‡?‡∏?∏®‡π?‡∏¢‡∏≠‡∏£‡∏°‡∏?∏µ ‡π?‡∏?∏≠‡∏°‡∏µ‡∏?∏∑‡π?∏≠‡π?‡∏?∏µ‡∏¢‡?‡π??‡π??‡∏?∏±‡∏??‡∏??‡∏≤‡?‡∏∞‡?‡∏π‡?‡π?‡∏?∏µ‡∏¢‡?‡∏?∏±‡∏??‡∏∂‡?‡∏?∏£‡∏∞‡?‡∏≥‡∏ß‡∏±‡?‡∏?∏∂‡π??‡∏??‡∏?∏°‡∏≤‡?‡∏??‡∏£‡∏±‡∏??‡∏≤‡∏£‡∏?∏µ‡∏?∏¥‡∏°‡?‡π??‡∏??‡∏?∏´‡∏?∏±‡∏?∏™‡∏∑‡∏≠ ‡∏?∏£‡∏£‡∏¢‡∏≤‡∏¢‡π?‡∏??‡∏∏‡?‡∏≤‡∏£‡∏??‡∏??‡∏∞‡∏´‡∏•‡?‡∏??‡∏??‡∏?∏±‡∏ß‡?‡∏≤‡?‡∏?∏≤‡∏£‡∏•‡π?∏≤‡∏?∏≤‡∏ß‡∏¢‡∏¥‡∏ß‡π??‡∏?∏£‡∏∞‡?‡∏?∏®‡π?‡∏??‡∏?∏≠‡∏£‡?‡π?∏•‡∏??‡π? ‡∏£‡∏∞‡∏?∏ß‡π?∏≤‡∏??‡∏µ‡?‡∏?∏π‡∏??‡∏¢‡∏≠‡∏£‡∏°‡∏?∏µ‡π?‡∏??‡∏≤‡?‡∏£‡∏≠‡∏??‡∏£‡∏≠‡∏??‡∏??‡π?∏ß‡∏?∏™‡∏??‡∏£‡∏≤‡∏°‡?‡∏•‡?‡∏?∏£‡∏±‡?‡∏??‡∏µ‡?‡∏?∏≠‡∏?");
     assertLang("ru", "id", "7ru", "name", "Lucene", "subject", "The Apache Lucene ?? ??–æ ?–≤–æ–±–æ–¥–Ω–∞? –±–∏–±–ª–∏–æ?–µ–∫–∞ –¥–ª? –≤??–æ–∫–æ?–∫–æ?–æ??–Ω–æ–≥–æ –ø–æ–ª–Ω–æ?–µ–∫??–æ–≤–æ–≥–æ –ø–æ–∏?–∫–∞, –Ω–∞–ø–∏?–∞–Ω–Ω–∞? –Ω–∞ Java. ?–æ–∂–µ? –±??? –∏?–ø–æ–ª?–∑–æ–≤–∞–Ω–∞ –¥–ª? –ø–æ–∏?–∫–∞ –≤ –∏–Ω?–µ?–Ω–µ?–µ –∏ –¥??–≥–∏? –æ–±–ª–∞???? –∫–æ–º–ø???–µ?–Ω–æ–π –ª–∏–Ω–≥–≤–∏??–∏–∫–∏ (–∞–Ω–∞–ª–∏?–∏?–µ?–∫–∞? ?–∏–ª–æ?–æ?–∏?).");
@@ -76,7 +76,17 @@ public abstract class LanguageIdentifierUpdateProcessorFactoryTestCase extends S
     assertLang("nl", "id", "10nl", "name", "Lucene", "subject", "Lucene is een gratis open source, tekst gebaseerde information retrieval API van origine geschreven in Java door Doug Cutting. Het wordt ondersteund door de Apache Software Foundation en is vrijgegeven onder de Apache Software Licentie. Lucene is ook beschikbaar in andere programeertalen zoals Perl, C#, C++, Python, Ruby en PHP.");
     assertLang("it", "id", "11it", "name", "Lucene", "subject", "Lucene √® una API gratuita ed open source per il reperimento di informazioni inizialmente implementata in Java da Doug Cutting. ? supportata dall'Apache Software Foundation ed √® resa disponibile con l'Apache License. Lucene √® stata successivamente reimplementata in Perl, C#, C++, Python, Ruby e PHP.");
     assertLang("pt", "id", "12pt", "name", "Lucene", "subject", "Apache Lucene, ou simplesmente Lucene, √© um software de busca e uma API de indexa√ß√£o de documentos, escrito na linguagem de programa√ß√£o Java. ? um software de c√≥digo aberto da Apache Software Foundation licenciado atrav√©s da licen√ßa Apache.");
+    // New in Tika1.0
+    assertLang("ca", "id", "13ca", "name", "Catalan", "subject", "El catal? posseeix dos est?ndards principals: el regulat per l'Institut d'Estudis Catalans, o est?ndard general, que pren com a base l'ortografia establerta per Pompeu Fabra amb els trets gramaticals i ortogr?fics caracter√≠stics del catal? central; i el regulat per l'Acad√®mia Valenciana de la Llengua, est?ndard d'?mbit restringit, centrat en l'estandarditzaci√≥ del valenci? i que pren com a base les Normes de Castell√≥, √©s a dir, l'ortografia de Pompeu Fabra per√≤ m√©s adaptada a la pron√∫ncia del catal? occidental i als trets que caracteritzen els dialectes valencians.");
+    assertLang("be", "id", "14be", "name", "Belarusian", "subject", "?–∞???–ø–Ω–∞–π –±?–π–Ω–æ–π –¥–∑??–∂–∞–≤–∞–π –Ω–∞ –±–µ–ª–∞???–∫–∞–π –∑?–º–ª? –±?–ª–æ ??–ª?–∫–∞–µ –∫–Ω???–≤–∞ ???–æ??–∫–∞–µ, ???–∫–∞–µ ? ?–∞–º–æ–π?–∫–∞–µ (???). ?–∞–¥?–∞? ??–≤–∞??–Ω–Ω? ? –ø–∞?–∞?–∫–æ–≤–∞–≥–∞ ?–∞–∑–≤???? –≥??–∞–π –¥–∑??–∂–∞–≤? –Ω–∞–π–±?–π–Ω–µ–π??–º ? –∞?–Ω–æ?–Ω?–º ?–µ ??–Ω??–∞–º –±?? ?–æ–≤–∞–≥–∞?–æ–¥–∞–∫. ?–∫?–∞–º? ???–∞?–Ω?? –∑–µ–º–ª?? ?–µ–ª–∞????, ? ?–∫–ª–∞–¥ –≥??–∞–π –¥–∑??–∂–∞–≤? ?–≤–∞?–æ–¥–∑?–ª? ?–∞–∫?–∞–º–∞ –∑–µ–º–ª? ???–∞?–Ω–∞–π ???–≤?, –ø–∞?–Ω–æ?–Ω–∞? ?–∞??–∫–∞ ???–∞?–Ω–∞–π –£–∫?–∞?–Ω? ? ?–∞??–∫–∞ ???–∞?–Ω–∞–π ?–∞???.");
+    assertLang("eo", "id", "15eo", "name", "Esperanto", "subject", "La vortprovizo de Esperanto devenas plejparte el la okcidente≈≠ropaj lingvoj, dum ?ia sintakso kaj morfologio montras anka≈≠ slavlingvan influon. La morfemoj ne ?an?i?as kaj oni povas ilin preska≈≠ senlime kombini, kreante diverssignifajn vortojn, Esperanto do havas multajn kunaƒµojn kun la analizaj lingvoj, al kiuj apartenas ekzemple la ?ina; kontra≈≠e la interna strukturo de Esperanto certagrade respegulas la aglutinajn lingvojn, kiel la japanan, svahilan a≈≠ turkan.");
+    assertLang("gl", "id", "16gl", "name", "Galician", "subject", "A cifra de falantes medrou axi√±a durante as d√©cadas seguintes, nun principio no Imperio ruso e na Europa oriental, logo na Europa occidental, Am√©rica, China e no Xap√≥n. Nos primeiros anos do movemento, os esperantistas manti√±an contacto por correspondencia, pero en 1905 o primeiro Congreso Universal de Esperanto levouse a cabo na cidade francesa de Boulogne-sur-Mer. Dende ent√≥n, os congresos mundiais organiz√°ronse nos cinco continentes ano tras ano ag√°s durante as d√∫as Guerras Mundiais.");
+    assertLang("ro", "id", "17ro", "name", "Romanian", "subject", "La momentul destr?m?rii Uniunii Sovietice ?i a √Ænl?tur?rii regimului comunist instalat √Æn Rom√¢nia (1989), ?ara a ini?iat o serie de reforme economice ?i politice. Dup? un deceniu de probleme economice, Rom√¢nia a introdus noi reforme economice de ordin general (precum cota unic? de impozitare, √Æn 2005) ?i a aderat la Uniunea European? la 1 ianuarie 2007.");
+    assertLang("sk", "id", "18sk", "name", "Slovakian", "subject", "Boli vytvoren√© dva n√°rodn√© parlamenty - ?esk√° n√°rodn√° rada a Slovensk√° n√°rodn√° rada a spolo?n√Ω jednokomorov√Ω ?esko-slovensk√Ω parlament bol premenovan√Ω z N√°rodn√©ho zhroma≈ædenia na Feder√°lne zhroma≈ædenie s dvoma komorami - Snemov?ou ƒæudu a Snemov?u n√°rodov.");
+    assertLang("sl", "id", "19sl", "name", "Slovenian", "subject", "Slovenska Wikipedija je razli?ica spletne enciklopedije Wikipedije v slovenskem jeziku. Projekt slovenske Wikipedije se je za?el 26. februarja 2002 z ustanovitvijo njene spletne strani, njen pobudnik pa je bil uporabnik Jani Melik.");
+    assertLang("uk", "id", "20uk", "name", "Ukrainian", "subject", "?–∞?–æ–¥–Ω–æ-–≥–æ?–ø–æ–¥–∞???–∫–∏–π –∫–æ–º–ø–ª–µ–∫? –∫?–∞?–Ω–∏ –≤–∫–ª??–∞? ?–∞–∫? –≤–∏–¥–∏ –ø?–æ–º–∏?–ª–æ–≤–æ??? ?–∫ –≤–∞–∂–∫–µ –º–∞?–∏–Ω–æ–±?–¥?–≤–∞–Ω–Ω?, ?–æ?–Ω–∞ ?–∞ –∫–æ–ª?–æ?–æ–≤–∞ –º–µ?–∞–ª??–≥??, ??–¥–Ω–æ–±?–¥?–≤–∞–Ω–Ω?, –≤–∏?–æ–±–Ω–∏??–≤–æ –∞–≤?–æ–±???–≤, –ª–µ–≥–∫–æ–≤–∏? ?–∞ –≤–∞–Ω?–∞–∂–Ω–∏? –∞–≤?–æ–º–æ–±?–ª?–≤, ??–∞–∫?–æ??–≤ ?–∞ ?–Ω?–æ? ??–ª???–∫–æ–≥–æ?–ø–æ–¥–∞???–∫–æ? ?–µ?–Ω?–∫–∏, ?–µ–ø–ª–æ–≤–æ–∑?–≤, –≤–µ???–∞??–≤, ???–±?–Ω, –∞–≤?–∞??–π–Ω–∏? –¥–≤–∏–≥?–Ω?–≤ ?–∞ –ª??–∞–∫?–≤, –æ–±–ª–∞–¥–Ω–∞–Ω–Ω? –¥–ª? –µ–ª–µ–∫??–æ??–∞–Ω??–π, –Ω–∞??–æ-–≥–∞–∑–æ–≤–æ? ?–∞ ??–º??–Ω–æ? –ø?–æ–º–∏?–ª–æ–≤–æ??? ?–æ?–æ. ???–º ?–æ–≥–æ, –£–∫?–∞?–Ω–∞ ? –ø–æ??–∂–Ω–∏–º –≤–∏?–æ–±–Ω–∏–∫–æ–º –µ–ª–µ–∫??–æ–µ–Ω–µ?–≥??. –£–∫?–∞?–Ω–∞ –º–∞? ?–æ–∑–≤–∏–Ω??–µ ??–ª???–∫–µ –≥–æ?–ø–æ–¥–∞???–≤–æ ? –∑–∞–π–º–∞? –æ–¥–Ω–µ –∑ –ø?–æ–≤?–¥–Ω–∏? –º???? ?–µ?–µ–¥ –µ–∫?–ø–æ??–µ??–≤ –¥–µ?–∫–∏? –≤–∏–¥?–≤ ??–ª???–∫–æ–≥–æ?–ø–æ–¥–∞???–∫–æ? –ø?–æ–¥?–∫??? ? –ø?–æ–¥–æ–≤–æ–ª???–≤–∞ (–∑–æ–∫?–µ–º–∞, ?–æ–Ω??–Ω–∏–∫–æ–≤–æ? –æ–ª??).");
   }
+    
   
   @Test
   public void testMapFieldName() throws Exception {

